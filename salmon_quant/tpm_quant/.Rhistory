install.packages("edgeR")
install.packages("swirl")
library(swirl)
swirl()
swirl()
num <- c(0.5, 55, -10, 6)
c(0.5, 55, -10, 6)
num_vect <- c(0.5, 55, -10, 6)
tf <- num_vect <1
tf
num_vect >=6
my_char <-c("My, "name", "is")
my_char <- c("My, "name", "is")
my_char <- c("My", "name", "is")
my_char
pase(my_char, collapse = " ")
paste(my_char, collapse = " ")
my_name <- c(my_char, "JDog Money")
my_name
paste(my_name, collapse = " ")
paste("Hello", "world!", sep = " ")
paste(1:3, c("X", "Y". "Z"), sep = "")
paste(1:3, c("X", "Y", "Z"), sep = "")
paste(LETTERS, 1:4, sep = "-")
x <- c(44, NA, 5, NA)
x*3
y <- rnorm(1000)
z <- rep(NA, 1000)
my_data <- sample(c(y,z), 100)
my_na <- in.na(my_data)
my_na <- is.na(my_data)
my_na
my_data == NA
sum(my_na)
my_data
0/0
Inf-Inf
x
x[1:10]
x[is.na(x)]
y <- x[!is.na(x)]
y
y[y > 0]
x[x > 0]
x[!is.na(x) & x > 0]
x[c(3, 5, 7)]
x[0]
x[3000]
x[c(-2, -10)]
x[-c(2, 10)]
vect <- c(foo = 11, bar = 2, norf = NA)
vect
play()
thing <- c(chips = 1, 2, 3, eat = 5, carp = 7, 100, NA)
thing
rm(thing)
nxt()
names(vect)
vect2 <- c(11, 2, NA)
names(nect2) <- c("foo", "bar", "norf")
names(vect2) <- c("foo", "bar", "norf")
identical(vect, vect2)
vect["bar"]
vect[c("foo", "bar")]
my_vector <- c(1:20)
my_vector <- 1:20
my_vector
dim(my_vector)
length(my_vector)
dim(my_vector) <- c(4,5)
dim(my_vector)
attributes(my_vector)
my_vector
class(my_vector)
my_matrix <- my_vector
?matrix
my_matrix2 <- matrix(data = 1:20, nrow = 4, ncol = 5)
identical(my_matrix, my_matrix2)
patients <- c("Bill", "Gina", "Kelly", "Sean")
cbin(patients, my_matrix)
cbind(patients, my_matrix)
my_data <- data.frame(patients, my_matrix)
my_Data
my_data
class(my_data)
cnames <- c("patient", "age", "weight", "bp", "rating", "test")
colnames(my_data) <- cnames
my_data
Print("Hello World!")
print("Hello World!")
library(swirl)
library(swirl)
swirl()
5 + 7
swirl()
TRUE == TRUE
(FALSE == TRUE) == FALSE
6 == 7
main()
6 < 7
SpeciesA <- ("Hydrophis major")
SpeciesB <- ("Rattus rattus")
SpeciesC <- ("Gorilla gorilla gorilla")
print(SpeciesA, [2])
print(SpeciesA, 2)
print(SpeciesA[2])
setwd("/Users/jennacrowe-riddell/Documents/tissue_profiling/salmon_quant/tpm_quant")
getwd()
setwd("/Users/jennacrowe-riddell/Documents/Research\ projects/Tail_photoreception/tissue_profiling/salmon_quant/tpm_quant")
setwd("C:\Users\L033060262053\Documents\Research projects\Tail_photoreception\tissue_profiling\salmon_quant\tpm_quant")
setwd("C:/Users/L033060262053/Documents/Research projects/Tail_photoreception/tissue_profiling/salmon_quant/tpm_quant")
dgePMucros <- read.table(file = "PMucros_quant_NumReads_all.tsv", header = TRUE)
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
library(magrittr)
library(tibble)
library(readr)
library(stringr)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(tidyverse)
library(pheatmap)
dgePMucros <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
rm(dgePMucros)
dgePMucros <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
dgePMucros <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
names(dgePMucros)
dgePMucros <- select(dgePMucros, GeneName = Name, HMAJ_testis = TPM, HMAJ_liver = TPM.1, HMAJ_heart = TPM.2, ALA_vno = TPM.3, ALA_tailA2 = TPM.4, ATEN_tailA2 = TPM.5,
ATEN_tailB5 = TPM.6, ATEN_body = TPM.7, ALA_eye = TPM.8, BRH_vno = TPM.9, ALAjuv_body = TPM.10, ALAjuv_tailA2 = TPM.11, ALAjuv_tailB5 = TPM.12, NSC_vno = TPM.13)
names(dgePMucros)
dgePMucros <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
names(dgePMucros)
dgePMucros <- select(dgePMucros, GeneName = Name,
dgePMucros <- select(dgePMucros, GeneName = Name,
HMAJ_testis_genelength = EffectiveLength,
HMAJ_testis = TPM,
HMAJ_liver_genelength = EffectiveLength.1,
HMAJ_liver = TPM.1,
HMAJ_heart_genelength = EffectiveLength.2,
HMAJ_heart = TPM.2,
ALA_vno_genelength = EffectiveLength.3,
ALA_vno = TPM.3,
ALA_tailA2_genelength = EffectiveLength.4,
ALA_tailA2 = TPM.4,
ATEN_tailA2_genelength = EffectiveLength.5,
ATEN_tailA2 = TPM.5,
ATEN_tailB5genelength = EffectiveLength.6,
ATEN_tailB5 = TPM.6,
ATEN_body_genelength = EffectiveLength.7,
ATEN_body = TPM.7,
ALA_eye_genelength = EffectiveLength.8,
ALA_eye = TPM.8,
BRH_vno_genelength = EffectiveLength.9,
BRH_vno = TPM.9,
ALAjuv_body_genelength = EffectiveLength.10,
ALAjuv_body = TPM.10,
ALAjuv_tailA2_genelength = EffectiveLength.11,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5_genelength = EffectiveLength.12,
ALAjuv_tailB5 = TPM.12,
NSC_vno_genelength = EffectiveLength.13,
NSC_vno = TPM.13)
kk
names(dgePMucros)
dgePMucros <- select(dgePMucros, GeneName = Name,
HMAJ_testis_genelength = EffectiveLength,
HMAJ_testis = TPM,
HMAJ_liver_genelength = EffectiveLength.1,
HMAJ_liver = TPM.1,
HMAJ_heart_genelength = EffectiveLength.2,
HMAJ_heart = TPM.2,
ALA_vno_genelength = EffectiveLength.3,
ALA_vno = TPM.3,
ALA_tailA2_genelength = EffectiveLength.4,
ALA_tailA2 = TPM.4,
ATEN_tailA2_genelength = EffectiveLength.5,
ATEN_tailA2 = TPM.5,
ATEN_tailB5genelength = EffectiveLength.6,
ATEN_tailB5 = TPM.6,
ATEN_body_genelength = EffectiveLength.7,
ATEN_body = TPM.7,
ALA_eye_genelength = EffectiveLength.8,
ALA_eye = TPM.8,
BRH_vno_genelength = EffectiveLength.9,
BRH_vno = TPM.9,
ALAjuv_body_genelength = EffectiveLength.10,
ALAjuv_body = TPM.10,
ALAjuv_tailA2_genelength = EffectiveLength.11,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5_genelength = EffectiveLength.12,
ALAjuv_tailB5 = TPM.12,
NSC_vno_genelength = EffectiveLength.13,
NSC_vno = TPM.13)
names(dgePMucros)
View(dgePMucros)
dgePMucros %<>% column_to_rownames("GeneName") %>%
as.matrix() %>%
edgeR::DGEList() %>%
edgeR::calcNormFactors()
mds <- limma::plotMDS(dgePMucros, gene.selection = "common", method = "logFC")
plot <- mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y")) %>%
left_join(sampleinfo, by = c("group"="gene_id"))
plot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
PMucros <- select(dgePMucros, GeneName = Name,
HMAJ_testis_genelength = EffectiveLength,
HMAJ_testis = TPM,
HMAJ_liver_genelength = EffectiveLength.1,
HMAJ_liver = TPM.1,
HMAJ_heart_genelength = EffectiveLength.2,
HMAJ_heart = TPM.2,
ALA_vno_genelength = EffectiveLength.3,
ALA_vno = TPM.3,
ALA_tailA2_genelength = EffectiveLength.4,
ALA_tailA2 = TPM.4,
ATEN_tailA2_genelength = EffectiveLength.5,
ATEN_tailA2 = TPM.5,
ATEN_tailB5genelength = EffectiveLength.6,
ATEN_tailB5 = TPM.6,
ATEN_body_genelength = EffectiveLength.7,
ATEN_body = TPM.7,
ALA_eye_genelength = EffectiveLength.8,
ALA_eye = TPM.8,
BRH_vno_genelength = EffectiveLength.9,
BRH_vno = TPM.9,
ALAjuv_body_genelength = EffectiveLength.10,
ALAjuv_body = TPM.10,
ALAjuv_tailA2_genelength = EffectiveLength.11,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5_genelength = EffectiveLength.12,
ALAjuv_tailB5 = TPM.12,
NSC_vno_genelength = EffectiveLength.13,
NSC_vno = TPM.13)
names(dgePMucros)
dgePMucros <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
names(dgePMucros)
PMucros <- select(dgePMucros, GeneName = Name,
HMAJ_testis_genelength = EffectiveLength,
HMAJ_testis = TPM,
HMAJ_liver_genelength = EffectiveLength.1,
HMAJ_liver = TPM.1,
HMAJ_heart_genelength = EffectiveLength.2,
HMAJ_heart = TPM.2,
ALA_vno_genelength = EffectiveLength.3,
ALA_vno = TPM.3,
ALA_tailA2_genelength = EffectiveLength.4,
ALA_tailA2 = TPM.4,
ATEN_tailA2_genelength = EffectiveLength.5,
ATEN_tailA2 = TPM.5,
ATEN_tailB5genelength = EffectiveLength.6,
ATEN_tailB5 = TPM.6,
ATEN_body_genelength = EffectiveLength.7,
ATEN_body = TPM.7,
ALA_eye_genelength = EffectiveLength.8,
ALA_eye = TPM.8,
BRH_vno_genelength = EffectiveLength.9,
BRH_vno = TPM.9,
ALAjuv_body_genelength = EffectiveLength.10,
ALAjuv_body = TPM.10,
ALAjuv_tailA2_genelength = EffectiveLength.11,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5_genelength = EffectiveLength.12,
ALAjuv_tailB5 = TPM.12,
NSC_vno_genelength = EffectiveLength.13,
NSC_vno = TPM.13)
names(PMucros)
dgePMucros <- select(PMucros, GeneName, HMAJ_testis, HMAJ_liver, HMAJ_heart, ALA_vno, ALA_tailA2, ATEN_tailA2,
ATEN_body, ALA_eye, BRH_vno, ALAjuv_body, ALA_juv_tailA2, ALAjuv_tailB5, NSC_vno)
dgePMucros <- select(PMucros, GeneName, HMAJ_testis, HMAJ_liver, HMAJ_heart, ALA_vno, ALA_tailA2, ATEN_tailA2,
ATEN_body, ALA_eye, BRH_vno, ALAjuv_body, ALAjuv_tailA2, ALAjuv_tailB5, NSC_vno)
View(dgePMucros)
dgePMucros %<>% column_to_rownames("GeneName") %>%
as.matrix() %>%
edgeR::DGEList() %>%
edgeR::calcNormFactors()
mds <- limma::plotMDS(dgePMucros, gene.selection = "common", method = "logFC")
plot <- mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y")) %>%
left_join(sampleinfo, by = c("group"="gene_id"))
plot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
dgePMucros <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
names(dgePMucros)
PMucros <- select(dgePMucros, GeneName = Name,
HMAJ_testis_genelength = EffectiveLength,
HMAJ_testis = TPM,
HMAJ_liver_genelength = EffectiveLength.1,
HMAJ_liver = TPM.1,
HMAJ_heart_genelength = EffectiveLength.2,
HMAJ_heart = TPM.2,
ALA_vno_genelength = EffectiveLength.3,
ALA_vno = TPM.3,
ALA_tailA2_genelength = EffectiveLength.4,
ALA_tailA2 = TPM.4,
ATEN_tailA2_genelength = EffectiveLength.5,
ATEN_tailA2 = TPM.5,
ATEN_tailB5genelength = EffectiveLength.6,
ATEN_tailB5 = TPM.6,
ATEN_body_genelength = EffectiveLength.7,
ATEN_body = TPM.7,
ALA_eye_genelength = EffectiveLength.8,
ALA_eye = TPM.8,
BRH_vno_genelength = EffectiveLength.9,
BRH_vno = TPM.9,
ALAjuv_body_genelength = EffectiveLength.10,
ALAjuv_body = TPM.10,
ALAjuv_tailA2_genelength = EffectiveLength.11,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5_genelength = EffectiveLength.12,
ALAjuv_tailB5 = TPM.12,
NSC_vno_genelength = EffectiveLength.13,
NSC_vno = TPM.13)
dgePMucros <- select(PMucros, GeneName, HMAJ_testis, HMAJ_liver, HMAJ_heart, ALA_vno, ALA_tailA2, ATEN_tailA2,
ATEN_body, ALA_eye, BRH_vno, ALAjuv_body, ALAjuv_tailA2, ALAjuv_tailB5, NSC_vno)
dgePMucros %<>% column_to_rownames("GeneName") %>%
as.matrix() %>%
edgeR::DGEList() %>%
edgeR::calcNormFactors()
mds <- limma::plotMDS(dgePMucros, gene.selection = "common", method = "logFC")
plot <- mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y")) %>%
left_join(sampleinfo, by = c("group"="gene_id"))
plot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
plot(hclust( d = dist(t(edgeR::cpm(dgePMucros)),  method = "euclidean"),
method = "ward.D"),
hang = -1, xlab = "Samples", sub = "Distance=euclidean; Method=ward.D")
View(PMucros)
tpmToFpkm <- PMucros %>% function(tpm, geneLength){
count <- apply(tpm, 2, function(e){ e/1000*geneLength })
fpkm <- apply(count, 2, function(e){ e*1000*1000000/sum(e)/geneLength })
return(fpkm)
}
tpmToFpkm <- function(tpm, geneLength){
count <- apply(tpm, 2, function(e){ e/1000*geneLength })
fpkm <- apply(count, 2, function(e){ e*1000*1000000/sum(e)/geneLength })
return(fpkm)
}
View(tpmToFpkm)
tpmToFpkm()
tpmToFpkm(PMucros$HMAJ_testis, {PMucros$HMAJ_testis_genelength})
plot %>%
ggplot(aes(x, y, colour = seqYear, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
View(PMucros)
tpmToFpkm(PMucros$HMAJ_testis, PMucros$HMAJ_testis_genelength)
pheatmap(TPM_Pmucros, cluster_rows = FALSE, cluster_cols = FALSE, color = colfunc, cutree_rows = 2)
setwd("C:/Users/L033060262053/Documents/Research projects/Tail_photoreception/tissue_profiling/salmon_quant/tpm_quant")
PMucros <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
names(PMucros)
PMucros <- select(dgePMucros, GeneName = Name,
HMAJ_testis_geneLength = Length,
HMAJ_testis = TPM,
HMAJ_liver_geneLength = Length.1,
HMAJ_liver = TPM.1,
HMAJ_heart_geneLength = Length.2,
HMAJ_heart = TPM.2,
ALA_vno_geneLength = Length.3,
ALA_vno = TPM.3,
ALA_tailA2_geneLength = Length.4,
ALA_tailA2 = TPM.4,
ATEN_tailA2_geneLength = Length.5,
ATEN_tailA2 = TPM.5,
ATEN_tailB5geneLength = Length.6,
ATEN_tailB5 = TPM.6,
ATEN_body_geneLength = Length.7,
ATEN_body = TPM.7,
ALA_eye_geneLength = Length.8,
ALA_eye = TPM.8,
BRH_vno_geneLength = Length.9,
BRH_vno = TPM.9,
ALAjuv_body_geneLength = Length.10,
ALAjuv_body = TPM.10,
ALAjuv_tailA2_geneLength = Length.11,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5_geneLength = Length.12,
ALAjuv_tailB5 = TPM.12,
NSC_vno_geneLength = Length.13,
NSC_vno = TPM.13)
PMucros <- select(PMucros, GeneName = Name,
PMucros <- select(PMucros, GeneName = Name,
PMucros <- select(PMucros, GeneName = Name,
HMAJ_testis_geneLength = Length,
HMAJ_testis = TPM,
HMAJ_liver_geneLength = Length.1,
HMAJ_liver = TPM.1,
HMAJ_heart_geneLength = Length.2,
HMAJ_heart = TPM.2,
ALA_vno_geneLength = Length.3,
ALA_vno = TPM.3,
ALA_tailA2_geneLength = Length.4,
ALA_tailA2 = TPM.4,
ATEN_tailA2_geneLength = Length.5,
ATEN_tailA2 = TPM.5,
ATEN_tailB5geneLength = Length.6,
ATEN_tailB5 = TPM.6,
ATEN_body_geneLength = Length.7,
ATEN_body = TPM.7,
ALA_eye_geneLength = Length.8,
ALA_eye = TPM.8,
BRH_vno_geneLength = Length.9,
BRH_vno = TPM.9,
ALAjuv_body_geneLength = Length.10,
ALAjuv_body = TPM.10,
ALAjuv_tailA2_geneLength = Length.11,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5_geneLength = Length.12,
ALAjuv_tailB5 = TPM.12,
NSC_vno_geneLength = Length.13,
NSC_vno = TPM.13)
dgePMucros <- select(PMucros, GeneName, HMAJ_testis, HMAJ_liver, HMAJ_heart, ALA_vno, ALA_tailA2, ATEN_tailA2,
ATEN_body, ALA_eye, BRH_vno, ALAjuv_body, ALAjuv_tailA2, ALAjuv_tailB5, NSC_vno)
PMucros <- select(PMucros, GeneName = Name,
HMAJ_testis_geneLength = Length,
HMAJ_testis = TPM,
HMAJ_liver_geneLength = Length.1,
HMAJ_liver = TPM.1,
HMAJ_heart_geneLength = Length.2,
HMAJ_heart = TPM.2,
ALA_vno_geneLength = Length.3,
ALA_vno = TPM.3,
ALA_tailA2_geneLength = Length.4,
ALA_tailA2 = TPM.4,
ATEN_tailA2_geneLength = Length.5,
ATEN_tailA2 = TPM.5,
ATEN_tailB5geneLength = Length.6,
ATEN_tailB5 = TPM.6,
ATEN_body_geneLength = Length.7,
ATEN_body = TPM.7,
ALA_eye_geneLength = Length.8,
ALA_eye = TPM.8,
BRH_vno_geneLength = Length.9,
BRH_vno = TPM.9,
ALAjuv_body_geneLength = Length.10,
ALAjuv_body = TPM.10,
ALAjuv_tailA2_geneLength = Length.11,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5_geneLength = Length.12,
ALAjuv_tailB5 = TPM.12,
NSC_vno_geneLength = Length.13,
NSC_vno = TPM.13)
View(PMucros)
dgePMucros <- select(PMucros, GeneName, HMAJ_testis, HMAJ_liver, HMAJ_heart, ALA_vno, ALA_tailA2, ATEN_tailA2,
ATEN_body, ALA_eye, BRH_vno, ALAjuv_body, ALAjuv_tailA2, ALAjuv_tailB5, NSC_vno)
tpmToFpkm <- function(tpm, geneLength){
count <- apply(tpm, 2, function(e){ e/1000*geneLength })
fpkm <- apply(count, 2, function(e){ e*1000*1000000/sum(e)/geneLength })
return(fpkm)
}
View(PMucros)
HMAJ_testisFpkm <- tpmToFpkm(tpm = PMucros$HMAJ_testis, geneLength = PMucros$HMAJ_testis_geneLength)

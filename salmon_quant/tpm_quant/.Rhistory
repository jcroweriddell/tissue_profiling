library(magrittr)
library(tibble)
library(readr)
library(stringr)
library(dplyr)
library(tidyverse)
setwd("/Users/jennacrowe-riddell/Documents/tissue_profiling/salmon_quant/tpm_results")
setwd("/Users/jennacrowe-riddell/Documents/tissue_profiling/salmon_quant/tpm_quant/")
refGenome <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
KRTgenes <- read_csv(file = "keratinGenes_PMucros.tsv", col_names = FALSE)
View(KRTgenes)
NSC_vno = TPM.13)
refGenome <- select(refGenome, GeneName = Name,
geneLength = Length,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.5,
ATEN_tailB5 = TPM.6,
ATEN_body = TPM.7,
ALA_eye = TPM.8,
BRH_vno = TPM.9,
ALAjuv_body = TPM.10,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5 = TPM.12,
NSC_vno = TPM.13)
View(refGenome)
KRTgenes <- select(KRTgenes, XM.geneid = X1, type = X2)
KRTgenes$XM.geneid <- gsub(">","", KRTgenes$XM.geneid)
View(KRTgenes)
KRTgenes <- separate(KRTgenes, XM.geneid, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
View(KRTgenes)
write.table(VRgenes, "KRTgenes_XMdescription", sep = "\t")
write.table(KRTgenes, "KRTgenes_XMdescription", sep = "\t")
geneList <- KRTgenes$XM.geneid
geneListKRT <- KRTgenes$XM.geneid
rm(geneList)
KRTGenesTPM <- filter(refGenome, GeneName %in% geneListKRT)
View(KRTGenesTPM)
write.table(KRTGenesTPM, "KRTgenesTPM_PMucros", sep = "\t")
KRTGenesTPMlog <- KRTGenesTPM %>%
column_to_rownames("GeneName") %>%
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
library(pheatmap)
library(RColorBrewer)
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
KRTGenesTPM <- refGenome %>% select(-geneLength) %>%
filter(GeneName %in% geneListKRT)
KRTGenesTPMlog <- KRTGenesTPM %>%
column_to_rownames("GeneName") %>%
as.matrix() %>%
log1p()
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
KRTGenesTPMlog <- KRTGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tail, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%
as.matrix() %>%
log1p()
KRTGenesTPMlog <- KRTGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%
as.matrix() %>%
log1p()
KRTGenesTPMlog <- KRTGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%
as.matrix() %>%
log1p()
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
border_colour = FALSE)
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = FALSE)
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 2,
cluster_cols = FALSE,
color = colfunc,
border_colour = FALSE)
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = FALSE)
border_colour = NA)
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
#cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
str_detect
str_detect(KRTgenes"XM_015821918.1")
str_detect(KRTgenes,"XM_015821918.1")
str_detect(KRTgenes$XM.geneid,"XM_015821918.1")
?str_detect
contains(KRTgenes$XM.geneid,"XM_015821918.1")
?contains
match(KRTgenes$XM.geneid,"XM_015821918.1")
select(match(KRTgenes$XM.geneid,"XM_015821918.1"))
print(match(KRTgenes$XM.geneid,"XM_015821918.1"))
OPNgenes <- read_csv(file = "OPNgenes_PMucros.tsv", col_names = FALSE)
View(OPNgenes)
OPNgenes <- select(OPNgenes, XM.geneid = X1, type = X2)
OPNgenes$XM.geneid <- gsub(">","", OPNgenes$XM.geneid)
OPNgenes <- separate(OPNgenes, XM.geneid, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
write.table(OPNgenes, "OPNgenes_XMdescription", sep = "\t")
View(OPNgenes)
OPNGenesTPM <-  refGenome %>% select(-geneLength) %>%
filter(GeneName %in% geneListOPN)
geneListOPN <- OPNgenes$XM.geneid
OPNGenesTPM <-  refGenome %>% select(-geneLength) %>%
filter(GeneName %in% geneListOPN)
write.table(OPNGenesTPM, "OPNgenesTPM_PMucros", sep = "\t")
View(OPNGenesTPM)
OPNGenesTPMlog <- OPNGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%
as.matrix() %>%
log1p()
pheatmap(OPNGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
refGenome <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
refGenome <- select(refGenome, GeneName = Name,
geneLength = Length,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ALA_eye = TPM.8,
ATEN_tailA2 = TPM.5,
ATEN_tailB5 = TPM.6,
ATEN_body = TPM.7,
BRH_vno = TPM.9,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5 = TPM.12,
ALAjuv_body = TPM.10,
NSC_vno = TPM.13)
OPNGenesTPM <-  refGenome %>% select(-geneLength) %>%
filter(GeneName %in% geneListOPN)
write.table(OPNGenesTPM, "OPNgenesTPM_PMucros", sep = "\t")
pheatmap(OPNGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
quartz()
pheatmap(KRTGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
pheatmap(OPNGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
OPNGenesTPMlog <- OPNGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%
as.matrix() %>%
log1p()
pheatmap(OPNGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
OPNGenesTPM <-  refGenome %>% select(-geneLength) %>%
filter(GeneName %in% geneListOPN)
write.table(OPNGenesTPM, "OPNgenesTPM_PMucros", sep = "\t")
OPNGenesTPMlog <- OPNGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%
as.matrix() %>%
log1p()
pheatmap(VRGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
pheatmap(OPNGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
refGenome <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
names(refGenome)
refGenome <- select(refGenome, GeneName = Name,
geneLength = Length,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ALA_eye = TPM.8,
ATEN_tailA2 = TPM.5,
ATEN_tailB5 = TPM.6,
ATEN_body = TPM.7,
BRH_vno = TPM.9,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5 = TPM.12,
ALAjuv_body = TPM.10,
NSC_vno = TPM.13)
OPNGenesTPMlog <- OPNGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%
as.matrix() %>%
log1p()
pheatmap(OPNGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
refGenome <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
OPNgenes <- read_csv(file = "OPNgenes_PMucros.tsv", col_names = FALSE)
names(refGenome)
refGenome <- select(refGenome, GeneName = Name,
geneLength = Length,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ALA_eye = TPM.8,
ATEN_tailA2 = TPM.5,
ATEN_tailB5 = TPM.6,
ATEN_body = TPM.7,
BRH_vno = TPM.9,
ALAjuv_tailA2 = TPM.11,
ALAjuv_tailB5 = TPM.12,
ALAjuv_body = TPM.10,
NSC_vno = TPM.13)
names(refGenome)
OPNgenes <- select(OPNgenes, XM.geneid = X1, type = X2)
OPNgenes$XM.geneid <- gsub(">","", OPNgenes$XM.geneid)
OPNgenes <- separate(OPNgenes, XM.geneid, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
write.table(OPNgenes, "OPNgenes_XMdescription", sep = "\t")
geneListOPN <- OPNgenes$XM.geneid
OPNGenesTPM <-  refGenome %>% select(-geneLength) %>%
filter(GeneName %in% geneListOPN)
write.table(OPNGenesTPM, "OPNgenesTPM_PMucros", sep = "\t")
OPNGenesTPMlog <- OPNGenesTPM %>%
column_to_rownames("GeneName") %>%
#select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
#HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%
as.matrix() %>%
log1p()
pheatmap(OPNGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(OPNGenesTPMlog,
cluster_rows = TRUE,
cutree_rows = 3,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)

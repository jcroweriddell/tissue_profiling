visGenes$geneName <- gsub("transcript variant*", "", visGenes$geneName)
geneList <- visGenes$XM.geneid
visGenesTPM <- filter(refGenome, GeneName %in% geneList) %>%
left_join(y = visGenes, by = c("GeneName" = "XM.geneid")) %>%
select(-GeneName, -Predicted) %>%
arrange(geneName)
visGenesTPMlog <- visGenesTPM %>%
column_to_rownames("geneName") %>%
select(ALA_eye, ALA_tailA2,ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_testis, HMAJ_heart, HMAJ_liver) %>%# set order of the tissues
as.matrix() %>%
log1p()
pheatmap(visGenesTPMlog,
cluster_rows = FALSE,
cluster_cols = FALSE,
color = colfunc,
border_color = NA,
#breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 4, 5.5, 7, 9),
main = "Python - phototransduction genes",
filename = "Python_visGenes_heatmap.jpeg")
rm(list = ls())
refGenome <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
visGenes <- read_csv(file = "refGenomes/PMucros_genelist/PMucros_visGenes3.txt", col_names = FALSE)
names(refGenome)
refGenome <- select(refGenome, Length, GeneName = Name,
)
refGenome <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
refGenome <- select(refGenome, Length, GeneName = Name,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.6,
ATEN_tailB5 = TPM.7,
ATEN_body = TPM.8,
ALA_eye = TPM.5,
BRH_vno = TPM.9,
ALAjuv_body = TPM.12,
ALAjuv_tailA2 = TPM.10,
ALAjuv_tailB5 = TPM.11,
NSC_vno = TPM.13)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
visGenes$geneName <- gsub("transcript variant*", "", visGenes$geneName)
View(visGenes)
visGenes <- read_csv(file = "refGenomes/PMucros_genelist/PMucros_visGenes3.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
visGenes$geneName <- gsub("transcript variant*", "", visGenes$geneName)
View(visGenes)
write.table(visGenes, "refGenomes/Python_heatmaps/visGenes_XMdescription", sep = "\t")
write.table(visGenes, "refGenomes/PMucros_heatmaps/visGenes_XMdescription", sep = "\t")
# Create a vetor of XM values
geneList <- visGenes$XM.geneid
visGenesTPM <- filter(refGenome, GeneName %in% geneList) %>%
left_join(y = visGenes, by = c("GeneName" = "XM.geneid")) %>%
select(-GeneName, -Predicted) %>%
arrange(geneName)
View(visGenesTPM)
write.table(visGenesTPM, "refGenomes/PMucros_heatmaps/visGenesTPM", sep = "\t")
visGenesTPMlog <- visGenesTPM %>%
column_to_rownames("geneName") %>%
select(ALA_eye, ALA_tailA2,ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_testis, HMAJ_heart, HMAJ_liver) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGenesTPMlog,
cluster_rows = FALSE,
cluster_cols = FALSE,
color = colfunc,
border_color = NA,
#breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 4, 5.5, 7, 9),
main = "P.Mucros - phototransduction genes",
filename = "PMucros_visGenes_heatmap.jpeg")
View(visGenesTPM)
pheatmap(visGenesTPMlog,
cluster_rows = FALSE,
cluster_cols = FALSE,
color = colfunc,
border_color = NA,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 4, 5.5, 7, 9),
main = "P.Mucros - phototransduction genes",
filename = "PMucros_visGenes_heatmap.jpeg")
rm(list = ls())
refGenome <- read.table(file = "Python_quant_tpm_all.tsv", header = TRUE)
refGenome <- read.table(file = "PythonMol_quant_tpm_all.tsv", header = TRUE)
visGenes <- read_csv(file = "refGenomes/Python_genelist/Python_visGenes.txt", col_names = FALSE)
refGenome <- select(refGenome, Length, GeneName = Name,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.6,
ATEN_tailB5 = TPM.7,
ATEN_body = TPM.8,
ALA_eye = TPM.5,
BRH_vno = TPM.9,
ALAjuv_body = TPM.12,
ALAjuv_tailA2 = TPM.10,
ALAjuv_tailB5 = TPM.11,
NSC_vno = TPM.13)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
visGenes$geneName <- gsub("transcript variant*", "", visGenes$geneName)
View(visGenes)
write.table(visGenes, "refGenomes/Python_heatmaps/visGenes_XMdescription", sep = "\t")
geneList <- visGenes$XM.geneid
visGenesTPM <- filter(refGenome, GeneName %in% geneList) %>%
left_join(y = visGenes, by = c("GeneName" = "XM.geneid")) %>%
select(-GeneName, -Predicted) %>%
arrange(geneName)
View(visGenesTPM)
write.table(visGenesTPM, "refGenomes/Python_heatmaps/visGenesTPM", sep = "\t")
visGenesTPMlog <- visGenesTPM %>%
column_to_rownames("geneName") %>%
select(ALA_eye, ALA_tailA2,ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_testis, HMAJ_heart, HMAJ_liver) %>%# set order of the tissues
as.matrix() %>%
log1p()
pheatmap(visGenesTPMlog,
cluster_rows = FALSE,
cluster_cols = FALSE,
color = colfunc,
border_color = NA,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 4, 5.5, 7, 9),
main = "Python - phototransduction genes",
filename = "Python_visGenes_heatmap.jpeg")
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGenesTPMlog,
cluster_rows = FALSE,
cluster_cols = FALSE,
color = colfunc,
border_color = NA,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 4, 5.5, 7, 9),
main = "Python - phototransduction genes",
filename = "Python_visGenes_heatmap.jpeg")
rm(list = ls())
refGenome <- read.table(file = "Gekko_quant_tpm_all.tsv", header = TRUE)
refGenome <- read.table(file = "Gekko_quant_tpm_all.tsv", header = TRUE)
visGenes <- read_csv(file = "refGenomes/Gekko_genelist/Gekko_visGenes.txt", col_names = FALSE)
refGenome <- select(refGenome, Length, GeneName = Name,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.6,
ATEN_tailB5 = TPM.7,
ATEN_body = TPM.8,
ALA_eye = TPM.5,
BRH_vno = TPM.9,
ALAjuv_body = TPM.12,
ALAjuv_tailA2 = TPM.10,
ALAjuv_tailB5 = TPM.11,
NSC_vno = TPM.13)
names(refGenome)
refGenome <- read.table(file = "Gecko_quant_tpm_all.tsv", header = TRUE)
names(refGenome)
refGenome <- read.table(file = "Chicken_quant_tpm_all.tsv", header = TRUE)
names(refGenome)
visGenes <- read_csv(file = "refGenomes/Gallus_genelist/Gallus_visGenes.txt", col_names = FALSE)
refGenome <- select(refGenome, Length, GeneName = Name,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.6,
ATEN_tailB5 = TPM.7,
ATEN_body = TPM.8,
ALA_eye = TPM.5,
BRH_vno = TPM.9,
ALAjuv_body = TPM.12,
ALAjuv_tailA2 = TPM.10,
ALAjuv_tailB5 = TPM.11,
NSC_vno = TPM.13)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
visGenes$geneName <- gsub("transcript variant*", "", visGenes$geneName)
View(visGenes)
visGenes <- read_csv(file = "refGenomes/Gallus_genelist/Gallus_visGenes.txt", col_names = FALSE)
View(visGenes)
visGenes <- read_csv(file = "refGenomes/Gallus_genelist/Gallus_visGenes.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
visGenes$geneName <- gsub("transcript variant*", "", visGenes$geneName)
View(visGenes)
write.table(visGenes, "refGenomes/Gallus_heatmaps/visGenes_XMdescription", sep = "\t")
write.table(visGenes, "refGenomes/Gallus_heatmaps/visGenes_XMdescription", sep = "\t")
geneList <- visGenes$XM.geneid
visGenesTPM <- filter(refGenome, GeneName %in% geneList) %>%
left_join(y = visGenes, by = c("GeneName" = "XM.geneid")) %>%
select(-GeneName, -Predicted) %>%
arrange(geneName)
View(visGenesTPM)
visGenes <- read_csv(file = "refGenomes/Gallus_genelist/Gallus_visGenes.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
visGenes$geneName <- gsub("transcript variant*", "", visGenes$geneName)
View(visGenes)
write.table(visGenes, "refGenomes/Gallus_heatmaps/visGenes_XMdescription", sep = "\t")
geneList <- visGenes$XM.geneid
# Filter refGenome by XM vOPN genes
visGenesTPM <- filter(refGenome, GeneName %in% geneList) %>%
left_join(y = visGenes, by = c("GeneName" = "XM.geneid")) %>%
select(-GeneName, -Predicted) %>%
arrange(geneName)
write.table(visGenesTPM, "refGenomes/Gallus_heatmaps/visGenesTPM", sep = "\t")
View(visGenesTPM)
visGenesTPMlog <- visGenesTPM %>%
column_to_rownames("geneName") %>%
select(ALA_eye, ALA_tailA2,ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_testis, HMAJ_heart, HMAJ_liver) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
View(visGenesTPMlog)
pheatmap(visGenesTPMlog,
cluster_rows = FALSE,
cluster_cols = FALSE,
color = colfunc,
border_color = NA,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 4, 5.5, 7, 9),
main = "Gallus - phototransduction genes",
filename = "Gallus_visGenes_heatmap.jpeg")
visGenesTPM %>% filter(geneName %in% "opn4")
visGenesTPM %>% filter(geneName %in% "OPN4")
visGenesTPM %>% filter(geneName %in% "OPN4*()")
visGenesTPM %>% filter(geneName == "OPN4")
visGenesTPM %>% filter(geneName == "OPN4-1")
visGenesTPM %>% filter(geneName == "OPN4-1 x1")
visGenesTPM %>% filter(geneName == "OPN4-1 X1")
visGenesTPM %>% filter(geneName == "OPN4-1  X1")
visGenesTPM %>% filter(geneName %in% "OPN4-1  X1")
rm(list = ls())
refGenome <- read.table(file = "PVil_quant_tpm_all.tsv", header = TRUE)
visGenes <- read_csv(file = "refGenomes/PVit_genelist/PVit_visGenes.txt", col_names = FALSE)
names(refGenome)
refGenome <- select(refGenome, Length, GeneName = Name,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.6,
ATEN_tailB5 = TPM.7,
ATEN_body = TPM.8,
ALA_eye = TPM.5,
BRH_vno = TPM.9,
ALAjuv_body = TPM.12,
ALAjuv_tailA2 = TPM.10,
ALAjuv_tailB5 = TPM.11,
NSC_vno = TPM.13)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
visGenes$geneName <- gsub("transcript variant*", "", visGenes$geneName)
View(visGenes)
write.table(visGenes, "refGenomes/Pogona_heatmaps/visGenes_XMdescription", sep = "\t")
write.table(visGenes, "refGenomes/Pogona_heatmaps/visGenes_XMdescription", sep = "\t")
geneList <- visGenes$XM.geneid
visGenesTPM <- filter(refGenome, GeneName %in% geneList) %>%
left_join(y = visGenes, by = c("GeneName" = "XM.geneid")) %>%
select(-GeneName, -Predicted) %>%
arrange(geneName)
View(visGenesTPM)
write.table(visGenesTPM, "refGenomes/Pogona_heatmaps/visGenesTPM", sep = "\t")
visGenesTPMlog <- visGenesTPM %>%
column_to_rownames("geneName") %>%
select(ALA_eye, ALA_tailA2,ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_testis, HMAJ_heart, HMAJ_liver) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGenesTPMlog,
cluster_rows = FALSE,
cluster_cols = FALSE,
color = colfunc,
border_color = NA,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 4, 5.5, 7, 9),
main = "Pogona - phototransduction genes",
filename = "Pogona_visGenes_heatmap.jpeg")
View(visGenesTPMlog)
rm(list = ls())
refGenome <- read.table(file = "Alligator_quant_tpm_all.tsv", header = TRUE)
visGenes <- read_csv(file = "refGenomes/Alligator_genelist/Alligator_visGenes.txt", col_names = FALSE)
refGenome <- select(refGenome, Length, GeneName = Name,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.6,
ATEN_tailB5 = TPM.7,
ATEN_body = TPM.8,
ALA_eye = TPM.5,
BRH_vno = TPM.9,
ALAjuv_body = TPM.12,
ALAjuv_tailA2 = TPM.10,
ALAjuv_tailB5 = TPM.11,
NSC_vno = TPM.13)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
visGenes$geneName <- gsub("transcript variant*", "", visGenes$geneName)
View(visGenes)
visGenes <- read_csv(file = "refGenomes/Alligator_genelist/Alligator_visGenes.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
visGenes$geneName <- gsub("transcript variant*", "", visGenes$geneName)
View(visGenes)
write.table(visGenes, "refGenomes/Alligator_heatmaps/visGenes_XMdescription", sep = "\t")
write.table(visGenes, "refGenomes/Alligator_heatmaps/visGenes_XMdescription", sep = "\t")
geneList <- visGenes$XM.geneid
visGenesTPM <- filter(refGenome, GeneName %in% geneList) %>%
left_join(y = visGenes, by = c("GeneName" = "XM.geneid")) %>%
select(-GeneName, -Predicted) %>%
arrange(geneName)
View(visGenesTPM)
write.table(visGenesTPM, "refGenomes/Alligator_heatmaps/visGenesTPM", sep = "\t")
visGenesTPMlog <- visGenesTPM %>%
column_to_rownames("geneName") %>%
select(ALA_eye, ALA_tailA2,ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_testis, HMAJ_heart, HMAJ_liver) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGenesTPMlog,
cluster_rows = FALSE,
cluster_cols = FALSE,
color = colfunc,
border_color = NA,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 4, 5.5, 7, 9),
main = "Alligator - phototransduction genes",
filename = "Alligator_visGenes_heatmap.jpeg")
rm(list = ls())
refGenome <- read.table(file = "PythonMol_quant_tpm_all.tsv", header = TRUE)
retGenes <- read_csv(file = "refGenomes/Python_genelist/Python_retGenes.txt", col_names = FALSE)
refGenome <- select(refGenome, GeneName = Name,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.6,
ATEN_tailB5 = TPM.7,
ATEN_body = TPM.8,
ALA_eye = TPM.5,
BRH_vno = TPM.9,
ALAjuv_body = TPM.12,
ALAjuv_tailA2 = TPM.10,
ALAjuv_tailB5 = TPM.11,
NSC_vno = TPM.13)
# Change column names, remove unwanted characters
# Create new column for 'Predicted' & 'geneName'
retGenes$X1 <- gsub(">","", retGenes$X1)
retGenes <- separate(retGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
retGenes$Predicted <- gsub("\\(", ",", retGenes$Predicted)
retGenes <- separate(retGenes, Predicted, c("Predicted", "geneName"), sep = ",")
retGenes$geneName <- gsub("\\)", "", retGenes$geneName)
retGenes$geneName <- gsub("mRNA", "", retGenes$geneName)
retGenes$geneName <- gsub("transcript variant*", "", retGenes$geneName)
View(retGenes)
geneList <- retGenes$XM.geneid
retGenesTPM <- filter(refGenome, GeneName %in% geneList) %>%
left_join(y = retGenes, by = c("GeneName" = "XM.geneid")) %>%
select(-GeneName, -Predicted) %>%
arrange(geneName)
View(retGenesTPM)
retGenesTPMlog <- retGenesTPM %>%
column_to_rownames("geneName") %>%
select(ALA_eye, ALA_tailA2,ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_testis, HMAJ_heart, HMAJ_liver) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(retGenesTPMlog,
cluster_rows = FALSE,
cluster_cols = FALSE,
color = colfunc,
border_color = NA,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
main = "Python- retinal metabolism genes",
filename = "Python_retGenes_heatmap.jpeg")
rm(list = ls())
refGenome <- read.table(file = "Chicken_quant_tpm_all.tsv", header = TRUE)
retGenes <- read_csv(file = "refGenomes/Gallus_genelist/Gallus_retGenes.txt", col_names = FALSE)
refGenome <- select(refGenome, GeneName = Name,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.6,
ATEN_tailB5 = TPM.7,
ATEN_body = TPM.8,
ALA_eye = TPM.5,
BRH_vno = TPM.9,
ALAjuv_body = TPM.12,
ALAjuv_tailA2 = TPM.10,
ALAjuv_tailB5 = TPM.11,
NSC_vno = TPM.13)
retGenes$X1 <- gsub(">","", retGenes$X1)
retGenes <- separate(retGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
retGenes$Predicted <- gsub("\\(", ",", retGenes$Predicted)
retGenes <- separate(retGenes, Predicted, c("Predicted", "geneName"), sep = ",")
retGenes$geneName <- gsub("\\)", "", retGenes$geneName)
retGenes$geneName <- gsub("mRNA", "", retGenes$geneName)
retGenes$geneName <- gsub("transcript variant*", "", retGenes$geneName)
View(retGenes)
retGenes <- read_csv(file = "refGenomes/Gallus_genelist/Gallus_retGenes.txt", col_names = FALSE)
retGenes$X1 <- gsub(">","", retGenes$X1)
retGenes <- separate(retGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
retGenes$Predicted <- gsub("\\(", ",", retGenes$Predicted)
retGenes <- separate(retGenes, Predicted, c("Predicted", "geneName"), sep = ",")
retGenes$geneName <- gsub("\\)", "", retGenes$geneName)
retGenes$geneName <- gsub("mRNA", "", retGenes$geneName)
retGenes$geneName <- gsub("transcript variant*", "", retGenes$geneName)
View(retGenes)
write.table(retGenes, "refGenomes/Gallus_heatmaps/retGenes_XMdescription", sep = "\t")
geneList <- retGenes$XM.geneid
retGenesTPM <- filter(refGenome, GeneName %in% geneList) %>%
left_join(y = retGenes, by = c("GeneName" = "XM.geneid")) %>%
select(-GeneName, -Predicted) %>%
arrange(geneName)
View(retGenesTPM)
write.table(retGenesTPM, "refGenomes/Gallus_heatmaps/retGenesTPM", sep = "\t")
retGenesTPMlog <- retGenesTPM %>%
column_to_rownames("geneName") %>%
select(ALA_eye, ALA_tailA2,ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_testis, HMAJ_heart, HMAJ_liver) %>%# set order of the tissues
as.matrix() %>%
log1p()
retGenesTPMlog <- retGenesTPM %>%
column_to_rownames("geneName") %>%
select(ALA_eye, ALA_tailA2,ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_testis, HMAJ_heart, HMAJ_liver) %>%# set order of the tissues
as.matrix() %>%
log1p()
retGenes <- read_csv(file = "refGenomes/Gallus_genelist/Gallus_retGenes.txt", col_names = FALSE)
retGenes$X1 <- gsub(">","", retGenes$X1)
retGenes <- separate(retGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
retGenes$Predicted <- gsub("\\(", ",", retGenes$Predicted)
retGenes <- separate(retGenes, Predicted, c("Predicted", "geneName"), sep = ",")
retGenes$geneName <- gsub("\\)", "", retGenes$geneName)
retGenes$geneName <- gsub("mRNA", "", retGenes$geneName)
retGenes$geneName <- gsub("transcript variant*", "", retGenes$geneName)
View(retGenes)
write.table(retGenes, "refGenomes/Gallus_heatmaps/retGenes_XMdescription", sep = "\t")
# Create a vetor of XM values
geneList <- retGenes$XM.geneid
# Filter refGenome by XM vOPN genes
retGenesTPM <- filter(refGenome, GeneName %in% geneList) %>%
left_join(y = retGenes, by = c("GeneName" = "XM.geneid")) %>%
select(-GeneName, -Predicted) %>%
arrange(geneName)
# Then look at TPM count table across tissues!
View(retGenesTPM)
write.table(retGenesTPM, "refGenomes/Gallus_heatmaps/retGenesTPM", sep = "\t")
# Heatmap
retGenesTPMlog <- retGenesTPM %>%
column_to_rownames("geneName") %>%
select(ALA_eye, ALA_tailA2,ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_testis, HMAJ_heart, HMAJ_liver) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(retGenesTPMlog,
cluster_rows = FALSE,
cluster_cols = FALSE,
color = colfunc,
border_color = NA,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
main = "Gallus- retinal metabolism genes",
filename = "Gallus_retGenes_heatmap.jpeg")

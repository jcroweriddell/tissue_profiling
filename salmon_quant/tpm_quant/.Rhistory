visGenes %>% as.data.frame()
visGenes <- visGenes %>% as.data.frame()
View(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
View(visGenes)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes <- gsub("\\(|]])", "'", visGenes$Predicted)
visGenes <- visGenes %>% as.data.frame()
View(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes %>% str_replace_all("\\(|\\)", "")
View(visGenes)
head(visGenes)
visGenes <- visGenes %>% str_replace_all("\\(|\\)", "")
head(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
View(visGenes)
head(visGenes)
visGenes <- visGenes %>% str_replace_all("\\(|\\)", ",|,")
head(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes <- visGenes %>% str_replace_all("\\(|\\)", ",")
head(visGenes)
read.table(visGenes, sep = ",")
head(visGenes)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes <- visGenes %>% as.data.frame()
head(visGenes)
View(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes <- visGenes %>% str_replace_all("\\(", ",")
head(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
View(visGenes)
visGenes$Predicted <- str_replace_all("\\(", ",")
visGenes <- visGenes %>% str_replace_all("\\(", ",", visGenes$Predicted)
visGenes <- str_replace_all("\\(", ",", visGenes$Predicted)
head(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- str_replace_all("\\(", ",", visGenes$Predicted)
View(visGenes)
View(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
View(visGenes)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName", sep = " ,")
visGenes <- gsub("\\(|]])", "'", visGenes$Predicted)
visGenes <- visGenes %>% as.data.frame()
head(visGenes)
gsub("\\[|\\]", "", n)
as.str
# Create new column with short gene name e.g. (GNAT)
visGenes %>% separate(Predicted, c("Predicted", "geneName"), sep = " (.*)")
pat <- "^(.*)"
test <- transform(visGenes, geneName = str_extract(Predicted, pat))
?str_extract
pat <- "(RED|GREEN|BLUE)"
dat <- transform(dat,search.color=stringr::str_extract(y,pat))
## dat
##   x              y search.color
## 1 1      BLUE,BALL         BLUE
## 2 2       BALL,RED          RED
## 3 3 BIG,GREEN,BALL        GREEN
## 4 4           BALL         <NA>
View(visGenes)
# Save VR gene list
write.table(visGenes, "visGenes_XMdescription", sep = "\t")
# Create a vetor of XM values
geneList <- visGenes$XM.geneid
# Filter refGenome by XM vOPN genes
visGenesTPM <- filter(refGenome, GeneName %in% geneList)
# Then look at TPM count table across tissues!
View(visGenesTPM)
write.table(visGenesTPM, "visGenesTPM_PMucros", sep = "\t")
# Heatmap
visGenesTPMlog <- visGenesTPM %>%
column_to_rownames("GeneName") %>%
# select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tail, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
# HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pdf(file = "plots/visGenes_heatmap_PMucros.pdf")
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
dev.off()
quartz()
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName", sep = " ,"))
View(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName", sep = ","))
View(visGenes)
?separate
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
test <- separate(visGenes, Predicted, c("geneName", sep = ","))
View(test)
View(test)
test <- separate(visGenes, Predicted, c("Predicted", "geneName", sep = ","))
View(test)
test <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
View(test)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
View(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
View(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
View(visGenes)
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
View(visGenes)
visGenes <- read_csv(file = "geneTPM_lists/visGenes_PMucros.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
View(visGenes)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
View(visGenes)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
View(visGenes)
write.table(visGenes, "visGenes_XMdescription", sep = "\t")
geneList <- visGenes$XM.geneid
visGenesTPM <- filter(refGenome, GeneName %in% geneList)
refGenome <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
names(refGenome)
refGenome <- select(refGenome, GeneName = Name,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.6,
ATEN_tailB5 = TPM.7,
ATEN_body = TPM.8,
ALA_eye = TPM.5,
BRH_vno = TPM.9,
ALAjuv_body = TPM.12,
ALAjuv_tailA2 = TPM.10,
ALAjuv_tailB5 = TPM.11,
NSC_vno = TPM.13)
visGenesTPM <- filter(refGenome, GeneName %in% geneList)
View(visGenesTPM)
write.table(visGenesTPM, "visGenesTPM_PMucros", sep = "\t")
visGenesTPMlog <- visGenesTPM %>%
column_to_rownames("GeneName") %>%
# select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tail, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
# HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA)
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA),
?pheatmap
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA,
labels_row = visGenes$geneName
?pheatmap
legend_breaks
cuttree_rows(3)
#dev.off()
quartz()
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA,
labels_row = visGenes$geneName)
visGenesTPMlog <- visGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tail, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
visGenesTPMlog <- visGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA,
labels_row = visGenes$geneName)
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA,
labels_row = visGenes$geneName,
cutree_rows = 4)
?pheatmap
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
border_colour = NA,
labels_row = visGenes$geneName,
cutree_rows = 4)
?pheatmap
View(visGenesTPMlog)
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.5, 0.75, 1, 2, 3, 4, 5, 6, 7),
border_colour = NA,
labels_row = visGenes$geneName,
cutree_rows = 4)
colfunc <- brewer.pal(n = 10, name = "OrRd")
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
border_colour = NA,
labels_row = visGenes$geneName,
cutree_rows = 4)
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
border_colour = "blue",
labels_row = visGenes$geneName,
cutree_rows = 4)
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = visGenes$geneName,
cutree_rows = 4)
visGenes <- read_csv(file = "/ref_genome_XMgenes/PMucros/visGenes_PMucros.txt", col_names = FALSE)
visGenes <- read_csv(file = "/ref_genome_XMgenes/PMucros/PMucros_visGenes2", col_names = FALSE)
setwd("/Users/L033060262053/Documents/Research projects/Tail_photoreception/tissue_profiling/salmon_quant/tpm_quant/")
visGenes <- read_csv(file = "/ref_genome_XMgenes/PMucros/PMucros_visGenes2", col_names = FALSE)
visGenes <- read_csv(file = "/ref_genome_XMgenes/PMucros/PMucros_visGenes2.txt", col_names = FALSE)
visGenes <- read_csv(file = "PMucros_genelist/PMucros_visGenes2.txt", col_names = FALSE)
visGenes <- read_csv(file = "PMucros_genelist/PMucros_visGenes2.txt", col_names = FALSE)
head(visGenes)
names(refGenome)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
View(visGenes)
rm(test)
View(visGenes)
visGenes <- read_csv(file = "PMucros_genelist/PMucros_visGenes2.txt", col_names = FALSE)
visGenes$X1 <- gsub(">","", visGenes$X1)
visGenes <- separate(visGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
visGenes$Predicted <- gsub("\\(", ",", visGenes$Predicted)
visGenes <- separate(visGenes, Predicted, c("Predicted", "geneName"), sep = ",")
visGenes$geneName <- gsub("\\)", "", visGenes$geneName)
visGenes$geneName <- gsub("mRNA", "", visGenes$geneName)
View(visGenes)
write.table(visGenes, "PMucros_R_analysis/visGenes_XMdescription", sep = "\t")
geneList <- visGenes$XM.geneid
visGenesTPM <- filter(refGenome, GeneName %in% geneList)
View(visGenesTPM)
write.table(visGenesTPM, "PMucros_R_analysis/visGenesTPM_PMucros", sep = "\t")
write.table(visGenesTPM, "PMucros_R_analysis/visGenesTPM", sep = "\t")
visGenesTPMlog <- visGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = visGenes$geneName,
cutree_rows = 4)
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = visGenes$geneName)
pdf(file = "plots/visGenes_heatmap.pdf")
pheatmap(visGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = visGenes$geneName)
dev.off()
retGenes <- read_csv(file = "PMucros_genelist/PMucros_retinalGenes.txt", col_names = FALSE)
head(visGenes)
refGenome <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
retGenes <- read_csv(file = "PMucros_genelist/PMucros_retinalGenes.txt", col_names = FALSE)
head(retGenes)
names(refGenome)
refGenome <- select(refGenome, GeneName = Name,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.6,
ATEN_tailB5 = TPM.7,
ATEN_body = TPM.8,
ALA_eye = TPM.5,
BRH_vno = TPM.9,
ALAjuv_body = TPM.12,
ALAjuv_tailA2 = TPM.10,
ALAjuv_tailB5 = TPM.11,
NSC_vno = TPM.13)
retGenes$X1 <- gsub(">","", retGenes$X1)
retGenes <- separate(retGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
retGenes$Predicted <- gsub("\\(", ",", retGenes$Predicted)
retGenes <- separate(retGenes, Predicted, c("Predicted", "geneName"), sep = ",")
retGenes$geneName <- gsub("\\)", "", retGenes$geneName)
retGenes$geneName <- gsub("mRNA", "", retGenes$geneName)
View(retGenes)
retGenes$geneName <- gsub("transcript variant X*", "", retGenes$geneName)
retGenes <- read_csv(file = "PMucros_genelist/PMucros_retinalGenes.txt", col_names = FALSE)
retGenes$X1 <- gsub(">","", retGenes$X1)
retGenes <- separate(retGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
retGenes$Predicted <- gsub("\\(", ",", retGenes$Predicted)
retGenes <- separate(retGenes, Predicted, c("Predicted", "geneName"), sep = ",")
retGenes$geneName <- gsub("\\)", "", retGenes$geneName)
retGenes$geneName <- gsub("mRNA", "", retGenes$geneName)
retGenes$geneName <- gsub("transcript variant X*", "", retGenes$geneName)
View(retGenes)
retGenes <- read_csv(file = "PMucros_genelist/PMucros_retinalGenes.txt", col_names = FALSE)
retGenes$X1 <- gsub(">","", retGenes$X1)
retGenes <- separate(retGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
retGenes$Predicted <- gsub("\\(", ",", retGenes$Predicted)
retGenes <- separate(retGenes, Predicted, c("Predicted", "geneName"), sep = ",")
retGenes$geneName <- gsub("\\)", "", retGenes$geneName)
retGenes$geneName <- gsub("mRNA", "", retGenes$geneName)
retGenes$geneName <- gsub("transcript variant*", "", retGenes$geneName)
View(retGenes)
write.table(retGenes, "PMucros_R_analysis/retGenes_XMdescription", sep = "\t")
geneList <- retGenes$XM.geneid
retGenesTPM <- filter(refGenome, GeneName %in% geneList)
View(retGenesTPM)
write.table(retGenesTPM, "PMucros_R_analysis/retGenesTPM", sep = "\t")
retGenesTPMlog <- retGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pdf(file = "PMucros_R_analysis/retGenes_heatmap.pdf")
pheatmap(retGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = retGenes$geneName)
dev.off()
pheatmap(retGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = retGenes$geneName)
View(retGenesTPM)
refGenome <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
retGenes <- read_csv(file = "PMucros_genelist/PMucros_clock.txt", col_names = FALSE)
head(retGenes)
rm(retGenes)
clockGenes <- read_csv(file = "PMucros_genelist/PMucros_clock.txt", col_names = FALSE)
names(refGenome)
refGenome <- select(refGenome, GeneName = Name,
HMAJ_testis = TPM,
HMAJ_liver = TPM.1,
HMAJ_heart = TPM.2,
ALA_vno = TPM.3,
ALA_tailA2 = TPM.4,
ATEN_tailA2 = TPM.6,
ATEN_tailB5 = TPM.7,
ATEN_body = TPM.8,
ALA_eye = TPM.5,
BRH_vno = TPM.9,
ALAjuv_body = TPM.12,
ALAjuv_tailA2 = TPM.10,
ALAjuv_tailB5 = TPM.11,
NSC_vno = TPM.13)
clockGenes$X1 <- gsub(">","", clockGenes$X1)
clockGenes <- separate(clockGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
clockGenes$Predicted <- gsub("\\(", ",", clockGenes$Predicted)
clockGenes <- separate(clockGenes, Predicted, c("Predicted", "geneName"), sep = ",")
clockGenes$geneName <- gsub("\\)", "", clockGenes$geneName)
clockGenes$geneName <- gsub("mRNA", "", clockGenes$geneName)
clockGenes$geneName <- gsub("transcript variant*", "", clockGenes$geneName)
View(clockGenes)
write.table(clockGenes, "PMucros_R_analysis/clockGenes_XMdescription", sep = "\t")
geneList <- clockGenes$XM.geneid
clockGenesTPM <- filter(refGenome, GeneName %in% geneList)
View(clockGenesTPM)
write.table(clockGenesTPM, "PMucros_R_analysis/clockGenesTPM", sep = "\t")
clockGenesTPMlog <- clockGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pdf(file = "PMucros_R_analysis/clockGenes_heatmap.pdf")
pheatmap(clockGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = clockGenes$geneName)
dev.off()
pheatmap(clockGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = clockGenes$geneName)
clockGenes <- read_csv(file = "PMucros_genelist/PMucros_keratin.txt", col_names = FALSE)
keratinGenes$X1 <- gsub(">","", keratinGenes$X1)
keratinGenes <- separate(keratinGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
keratinGenes <- read_csv(file = "PMucros_genelist/PMucros_keratin.txt", col_names = FALSE)
head(keratinGenes)
keratinGenes$X1 <- gsub(">","", keratinGenes$X1)
keratinGenes <- separate(keratinGenes, X1, c("XM.geneid", "Predicted"), sep = " PREDICTED: ")
keratinGenes$Predicted <- gsub("\\(", ",", keratinGenes$Predicted)
keratinGenes <- separate(keratinGenes, Predicted, c("Predicted", "geneName"), sep = ",")
keratinGenes$geneName <- gsub("\\)", "", keratinGenes$geneName)
keratinGenes$geneName <- gsub("mRNA", "", keratinGenes$geneName)
keratinGenes$geneName <- gsub("transcript variant*", "", keratinGenes$geneName)
View(keratinGenes)
write.table(keratinGenes, "PMucros_R_analysis/keratinGenes_XMdescription", sep = "\t")
geneList <- keratinGenes$XM.geneid
keratinGenesTPM <- filter(refGenome, GeneName %in% geneList)
View(keratinGenesTPM)
write.table(keratinGenesTPM, "PMucros_R_analysis/keratinGenesTPM", sep = "\t")
keratinGenesTPMlog <- keratinGenesTPM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pdf(file = "PMucros_R_analysis/keratinGenes_heatmap.pdf")
pheatmap(keratinGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = keratinGenes$geneName)
dev.off()
pheatmap(keratinGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = keratinGenes$geneName)
pheatmap(keratinGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = keratinGenes$geneName.
cutree_rows = 3)
pheatmap(keratinGenesTPMlog,
cluster_rows = TRUE,
cluster_cols = FALSE,
color = colfunc,
breaks = c(0, 0.25, 0.5, 0.75, 1, 2, 3, 4.5, 6, 7),
labels_row = keratinGenes$geneName,
cutree_rows = 3)
source('~/Research projects/Tail_photoreception/tissue_profiling/scripts/keratinGenes_heatmap.R')

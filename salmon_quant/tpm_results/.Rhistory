confint(model2, 'HV', level=0.95)
library(lmodel2)
RMA_N <-lmodel2(N~HV, data=Sensilla.csv,nperm=99)
RMA_N <-lmodel2(N~HV, data=Sensilla,nperm=99)
??lmodel2
RMA_N <-lmodel2(N~HV, data=Sensilla,range.y="interval", range.x= "interval", nperm=99)
regression.results(RMA_N)
summary(RMA_N)
plot(RMA_N, main="RMA Number of Sensilla", xlab="Head volume", ylab="Sensilla number")
plot(RMA_N, main="RMA Number of Sensilla", pch=16, xlab="Head volume", ylab="Sensilla number")
View(RMA_N)
summary(RMA_N)
View(newdata)
summary(RMA_N)
regression.results(RMA_N)
regression.results
RMA_N <- regression.results
RMA_N
RMA_D <-lmodel2(D~HV, data=Sensilla,range.y="interval", range.x= "interval", nperm=99)
RMA_D
plot(RMA_D, main="RMA Sensilla density", pch=16, xlab="Head volume", ylab="Sensilla density")
RMA_AP <-lmodel2(AP~HV, data=Sensilla,range.y="interval", range.x= "interval", nperm=99)
RMA_AP
plot(RMA_AP, main="RMA Area of post-oculars", pch=16, xlab="Head volume", ylab="Post-ocular area")
RMA_AM <-lmodel2(AM~HV, data=Sensilla,range.y="interval", range.x= "interval", nperm=99)
RMA_AM
plot(RMA_AM, main="RMA Mean sensilla area", pch=16, xlab="Head volume", ylab="Mean sensilla area")
RMA_AD <-lmodel2(AD~HV, data=Sensilla,range.y="interval", range.x= "interval", nperm=99)
RMA_AD
plot(RMA_AD, main="RMA Relative area", pch=16, xlab="Head volume", ylab="Relative area of sensilla")
RMA_AM_test <-lmodel2(AM~HV, data=Sensilla, nperm=99)
RMA_AM_test
Sensilla <- read.csv(file.choose(), header=T)
RMA_N <-lmodel2(N~HV, data=Sensilla, nperm=99)
RMA_N
RMA_D <-lmodel2(D~HV, data=Sensilla, nperm=99)
RMA_D
RMA_AP <-lmodel2(AP~HV, data=Sensilla, nperm=99)
RMA_AM <-lmodel2(AM~HV, data=Sensilla, nperm=99)
RMA_AD <-lmodel2(AD~HV, data=Sensilla, nperm=99)
RMA_D <-lmodel2(D~HV, data=Sensilla, nperm=99)
RMA_AP
RMA_AM
RMA_AD
RMA_N <-lmodel2(N~HV, data=Sensilla)
RMA_N
library(ggplot2)
scatterN <- ggplot() + geom_point(aes(x=HV), y=N), data=Sensilla) +labs(title="Sensilla Number"~"Head Volume")+ theme_bw(25)
scatterN <- ggplot(aes(HV, N), data=Sensilla)+ geom_point()+labs(title="Sensilla Number"~"Head Volume")+ theme_bw(25)
test <-ggplot(Sensilla, aes(HV,N))
test <-ggplot(Sensilla, aes(HV,N)) p+geom_point()
test <-ggplot(Sensilla, aes(HV,N))
test + geom_point()
test2 <-ggplot(Sensilla, aes(HV,D))
test2+geom_point()
test2+geom_point(aes(colour = factor(Species)))
Sensilla <- read.csv(file.choose(), header=T)
scatterD <-ggplot(SensillaHab, aes(HV,D)), scatterD+geom_point(aes(colour = actor(Habitat)))
scatterD <-ggplot(SensillaHab, aes(HV,D)) scatterD+geom_point(aes(colour = actor(Habitat)))
scatterD <-ggplot(SensillaHab, aes(HV,D)) + scatterD+geom_point(aes(colour = actor(Habitat)))
SensillaHab
View(Sensilla)
scatterD <-ggplot(Sensilla, aes(HV,D)) + scatterD+geom_point(aes(colour = actor(Habitat)))
scatterD <-ggplot(Sensilla, aes(HV,D))
scatter +geom_point(aes(colour = factor(Habitat)))
scatterD +geom_point(aes(colour = factor(Habitat)))
scatterD +geom_point(aes(colour = factor(Habitat)), size=4 +geom_point(colour="grey90", size=1.5))
scatterD <-ggplot(Sensilla, aes(HV,D))+geom_point(Sensilla, aes(HV,D))+ labs(title="Sensilla Density over Head Volume")
scatterD <-ggplot(Sensilla, aes(HV,D))+geom_point(scatterD, aes(HV,D))+ labs(title="Sensilla Density over Head Volume")
scatterD +geom_point(aes(colour = factor(Habitat)))
scatterD +geom_point()+labs(title="Sensilla Density")+ theme_bw(25)
OLS_model <-1m(D~HV, data=Sensilla)
OLS_model <-lm(D~HV, data=Sensilla)
summary(OLS_model)
RMA_model <-lmodel2(D~HV, data=Sensilla)
summary(RMA_model)
reg_lines <-data.frame(slopes = c(RMA_model$regression.results[3,3],coef(OLS_model)[2]), intercepts = c(RMA_model$regression.results[3,2], coef(OLS_model)[1]), method=c("RMA", "OLS"))
scatter +geom_abline(aes(slope=slopes, intercept=intercepts, linetype=method, color=method), data=reg_lines)+annotate(geom="test", x= 3.5, y=c(2,1.8), label=c("RMA line", "OLS line", color=c("green","red"))
)
scatterD +geom_abline(aes(slope=slopes, intercept=intercepts, linetype=method, color=method), data=reg_lines)+annotate(geom="test", x= 3.5, y=c(2,1.8), label=c("RMA line", "OLS line", color=c("green","red"))
)
scatterD +geom_abline(aes(slope=slopes, intercept=intercepts, linetype=method, color=method), data=reg_lines)+annotate(geom="test", x= 4.0, y=c(1.5,1), label=c("RMA line", "OLS line", color=c("green","red")))
scatterD +geom_abline(aes(slope=slopes, intercept=intercepts, linetype=method, color=method), data=reg_lines)
scatterD +geom_abline(aes(slope=slopes, intercept=intercepts, linetype=method, color=method), data=reg_lines))
scatterD +geom_abline(aes(slope=slopes, intercept=intercepts, linetype=method, color=method), data=reg_lines)
scatterD +geom_abline(aes(slope=slopes, intercept=intercepts, linetype=method, color=method), data=reg_lines)
scatterD +geom_abline(aes(slope=slopes, intercept=intercepts, linetype=method, color=method), data=reg_lines) +annotate(geom="text", x= 3.0, y=c(1.5,2), label=c("RMA line", "OLS line", color=c("green","red")))
scatterD +geom_abline(aes(slope=slopes, intercept=intercepts, linetype=method, color=method), data=reg_lines)
scatterD
scatter +geom_point(aes(colour = factor(Habitat)))
scatterD +geom_point()+labs(title="Sensilla Density")+ theme_bw(25)
scatter D + stat_smooth(method="lm", se=FALSE)
scatterD + stat_smooth(method="lm", se=FALSE)
scatterD +geom_point()+labs(title="Sensilla Density")+ theme_bw(25)+stat_smooth(method="lm", se=FALSE)
scatterD +geom_point()+labs(title="Sensilla Density")+ theme_bw(25)+stat_smooth(method="lm", se=FALSE) +stat_smooth(melod="lmodel2, se=F")
scatterD +geom_point()+labs(title="Sensilla Density")+ theme_bw(25)+stat_smooth(method="lm", se=FALSE) +stat_smooth(melod="lmodel2", se=F)
RStudio.Version()
library(‘dplyr’)
library('dplyr')
library('ggplot2’)
library('robustbase')
library('ggplot2')
Regressions <- read.csv(file.choose(), header=T)#load data
Density <-ggplot(Regressions, aes(HV,D,col=Habitat))
Density + geom_point() + #create plot for numerical density ~ head volume, coloured by Habitat
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") #labels x axis +
ylab("Numerical Density of Sensilla") + #labels y axis
ggtitle("Numerical density over head volume") #labels graph
Number <-ggplot(Regressions, aes(HV,N,col=Habitat))
Number + geom_point() + #create plot for numerical n ~ head volume, coloured by Habitat
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") #labels x axis +
ylab("Number of Sensilla") + #labels y axis
ggtitle("Number of sensilla over head volume") #labels graph
xlab("Head Volume")+ #labels x axis +
ylab("Number of Sensilla") + #labels y axis
ggtitle("Number of sensilla over head volume") #labels graph
Number + geom_point() + #create plot for numerical n ~ head volume, coloured by Habitat
geom_smooth(method=lm,se=F)+ #add regression lines
xlab("Head Volume")+ #labels x axis +
ylab("Number of Sensilla") + #labels y axis
ggtitle("Number of sensilla over head volume") #labels graph
Density + geom_point() + #create plot for numerical density ~ head volume, coloured by Habitat
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") #labels x axis +
ylab("Numerical Density of Sensilla") + #labels y axis
ggtitle("Numerical density over head volume") #labels graph
Density + geom_point() + #create plot for numerical density ~ head volume, coloured by Habitat
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") + #labels x axis
ylab("Numerical Density of Sensilla") + #labels y axis
ggtitle("Numerical density over head volume") #labels graph
Size <-ggplot(Regressions, aes(HV,N,col=Habitat))
Size + geom_point() + #create plot for numerical n ~ head volume, coloured by Habitat
geom_smooth(method=lm,se=F)+ #add regression lines
xlab("Head Volume")+ #labels x axis
ylab("Mean sensillum size of Sensilla") + #labels y axis
ggtitle("Mean sensillum size over head volume") #labels graph
Coverage <-ggplot(Regressions, aes(HV,N,col=Habitat))
Coverage + geom_point() + #create plot for numerical n ~ head volume, coloured by Habitat
geom_smooth(method=lm,se=F)+ #add regression lines
xlab("Head Volume")+ #labels x axis
ylab("Coverage of Sensilla") + #labels y axis
ggtitle("Coverage of Sensilla over head volume") #labels graph
Regressions
#Size ~ Head volume
Size <-ggplot(Regressions, aes(HV,AM,col=Habitat))
Size + geom_point() + #create plot for numerical n ~ head volume, coloured by Habitat
geom_smooth(method=lm,se=F)+ #add regression lines
xlab("Head Volume")+ #labels x axis
ylab("Mean sensillum size") + #labels y axis
ggtitle("Mean sensillum size over head volume") #labels graph
#Coverage ~ Head volume
Coverage <-ggplot(Regressions, aes(HV,AD,col=Habitat))
Coverage + geom_point() + #create plot for numerical n ~ head volume, coloured by Habitat
geom_smooth(method=lm,se=F)+ #add regression lines
xlab("Head Volume")+ #labels x axis
ylab("Coverage of Sensilla") + #labels y axis
ggtitle("Coverage of Sensill over head volume") #labels graph
Regressions
Regressions %>% arrange(Habitat)
Regressions %>% order(terrestrial)
Regressions %>% order(terrestrial)
Regressions %>% arrange(terrestrial)
Regressions %>% arrange(Habitat(terrestrial)
)
Regressions %>% arrange(Habitat)
Sorted <-Regressions[order(-Habitat),]
Regressions
sort(Habitat)
Regressions %>% sort(Habitat)
Regressions %>% arrange(-Habitat)
sort(Regressions,decreasing=T)
Regressions %>% sort(Habitat, decreasing=T)
Regressions %>% sort(Habitat)
Regressions %>% order(Habitat)
Regressions %>% arrange(Habitat)
Regressions %>% arrange(-Habitat)
Regressions %>% arrange(Habitat,decreasing=T)
Regressions <- read.csv(file.choose(), header=T)#load data
Regressions2 <- read.csv(file.choose(), header=T)#load data
#Density ~ Head volume
Density <-ggplot(Regressions, aes(HV,D,col=Habitat))
Density + geom_point() + #create plot for numerical density ~ head volume, coloured by Habitat
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") + #labels x axis
ylab("Numerical Density of Sensilla") + #labels y axis
ggtitle("Numerical density over head volume") #labels graph
Density <-ggplot(Regressions, aes(HV,D,col=Habitat))
Density + geom_point(col=) +#create plot for numerical density ~ head volume, coloured by Habitat
sclae_colrour_manual(name="", values=c("blue", "green", "red")) +
Density + geom_point(col=) +#create plot for numerical density ~ head volume, coloured by Habitat
sclae_colrour_manual(name="", values=c("blue", "green", "red")) +
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") + #labels x axis
ylab("Numerical Density of Sensilla") + #labels y axis
ggtitle("Numerical density over head volume") #labels graph
Density + geom_point(col=) +#create plot for numerical density ~ head volume, coloured by Habitat
sclae_colour_manual(name="t", values=c("blue", "green", "red"))
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") + #labels x axis
ylab("Numerical Density of Sensilla") + #labels y axis
ggtitle("Numerical density over head volume") #labels graph
Density + geom_point(col=) +#create plot for numerical density ~ head volume, coloured by Habitat
sclae_colour_manual(name="t", values=c("blue", "green", "red")) +
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") + #labels x axis
ylab("Numerical Density of Sensilla") + #labels y axis
ggtitle("Numerical density over head volume") #labels graph
Density + geom_point(col=) +#create plot for numerical density ~ head volume, coloured by Habitat
scale_colour_manual(name="", values=c("blue", "green", "red"))
Density + geom_point() + #create plot for numerical density ~ head volume, coloured by Habitat
scale_colour_manual(name="", values=c("blue", "green", "red"))
Density + geom_point() + #create plot for numerical density ~ head volume, coloured by Habitat
scale_colour_manual(name="", values=c("blue", "green", "red")) +
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") + #labels x axis
ylab("Numerical Density of Sensilla") + #labels y axis
ggtitle("Numerical density over head volume") #labels graph
Density + geom_point() + #create plot for numerical density ~ head volume, coloured by Habitat
scale_colour_manual(name="", values=c("blue", "green", "red")) + scale_fill_hue(c=45, l=80) + # specify colour for each Habitat type
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") + #labels x axis
ylab("Numerical Density of Sensilla") + #labels y axis
ggtitle("Numerical density over head volume") #labels graph
Density + geom_point() + #create plot for numerical density ~ head volume, coloured by Habitat
scale_colour_manual(name="", values=c("blue", "green", "red"))+ geom_bar(stat="identity") + scale_fill_hue(c=45, l=80) + # specify colour for each Habitat type
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") + #labels x axis
ylab("Numerical Density of Sensilla") + #labels y axis
ggtitle("Numerical density over head volume") #labels graph
Density + geom_point() + #create plot for numerical density ~ head volume, coloured by Habitat
scale_colour_manual(values=c("blue", "green", "red")) + # specify colour for each Habitat type
geom_smooth(method=lm,se=F) + #add regression lines
xlab("Head Volume") + #labels x axis
ylab("Numerical Density of Sensilla") + #labels y axis
ggtitle("Numerical density over head volume") #labels graph
Number + geom_point() + #create plot for numerical n ~ head volume, coloured by Habitat
scale_colour_manual(values=c("blue", "green", "red")) + # specify colour for each Habitat type
geom_smooth(method=lm,se=F)+ #add regression lines
xlab("Head Volume")+ #labels x axis
ylab("Number of Sensilla") + #labels y axis
ggtitle("Number of sensilla over head volume") #labels graph
Size + geom_point() + #create plot for numerical n ~ head volume, coloured by Habitat
scale_colour_manual(values=c("blue", "green", "red")) + # specify colour for each Habitat type
geom_smooth(method=lm,se=F)+ #add regression lines
xlab("Head Volume")+ #labels x axis
ylab("Mean sensillum size") + #labels y axis
ggtitle("Mean sensillum size over head volume") #labels graph
Coverage + geom_point() + #create plot for numerical n ~ head volume, coloured by Habitat
scale_colour_manual(values=c("blue", "green", "red")) + # specify colour for each Habitat type
geom_smooth(method=lm,se=F)+ #add regression lines
xlab("Head Volume")+ #labels x axis
ylab("Coverage of Sensilla") + #labels y axis
ggtitle("Coverage of Sensill over head volume") #labels graph
Aquaticspp <- read.csv(file.choose(), header=T)
modelAquaticspp <-lm(D~HV +N, data= Aquaticspp) #linear model
modelAquaticspp <-lm(AD~HV +N, data= Aquaticspp) #linear model
summary(modelAquaticspp) #display results
confint(model, 'HV', level=0.95) # display 95% confidence intervals
AquaticOLS <-lm(AD~HV, data= Aquaticspp) #OLS of coverage ~ head volume
summary(modelAquaticspp) #display results
confint(model, 'HV', level=0.95) # display 95% confidence intervals
summary(AquaticOLS) + #display results
confint(AquaticOLS) 'HV', level=0.95) # display 95% confidence intervals
summary(AquaticOLS) #display OLS results
confint(AquaticOLS) 'HV', level=0.95) # display 95% confidence intervals
confint(AquaticOLS, 'HV', level=0.95) # display 95% confidence intervals
confint(AquaticOLS, 'AD', level=0.95) # display 95% confidence intervals
SizeDen <-ggplot(Regressions, aes(D,AM,col=Habitat))
SizeDen + geom_point() + #create plot for numerical n ~ head volume, coloured by Habitat
scale_colour_manual(values=c("blue", "green", "red")) + # specify colour for each Habitat type
geom_smooth(method=lm,se=F)+ #add regression lines
xlab("Numerical-density of sensilla")+ #labels x axis
ylab("Mean sensillum size") + #labels y axis
ggtitle("mean size over numerical-density") #labels graph
SizeDen2 <-ggplot(Regressions, aes(D,AM))
SizeDen2 + geom_point() +
geom_smooth(method=lm,se=F)+ #add regression lines
xlab("Numerical-density of sensilla")+ #labels x axis
ylab("Mean sensillum size") + #labels y axis
ggtitle("mean size over numerical-density") #labels graph
#size ~ density
SizeDen <-ggplot(Regressions, aes(D,AM,col=Habitat))
SizeDen + geom_point() + #create plot for numerical n ~ head volume, coloured by Habitat
scale_colour_manual(values=c("blue", "green", "red")) + # specify colour for each Habitat type
geom_smooth(method=lm,se=F)+ #add regression lines
xlab("Numerical-density of sensilla")+ #labels x axis
ylab("Mean sensillum size") + #labels y axis
ggtitle("mean size over numerical-density") #labels graph
library(magrittr)
library(tibble)
library(readr)
library(dplyr)
library(ggplot2)
library(edgeR)
library(RColorBrewer)
library(tidyverse)
library(pheatmap)
install.packages("edgeR")
sessioninfo()
sessionInfo()
sessionInfo()
install.packages("edgeR")
source("https://bioconductor.org/biocLite.R")
source("https://bioconductor.org/biocLite.R")
source("http://bioconductor.org/biocLite.R")
source("http://bioconductor.org/biocLite.R")
biocLite()
setwd("/Users/jennacrowe-riddell/Documents/tissue_profiling/salmon_quant/tpm_results")
dgePMucros <- read.table(file = "PMucros_quant_tpm_all.tsv",
header = TRUE)
names(dgePMucros)
rename(dgePMucros, TPM = HMAJ_testis, TPM.1 = HMAJ_heart, TPM.3 = ALA_vno, TPM.3 = ALA_tailA2, TPM.4 = ATEN_tailA2,
TPM.5 = ATEN_tailB5, TPM.6 = ATEN_body, TPM.7 = ALA_eye, TPM.8 = BRH_vno, TPM.9 = ALAjuv_body, TPM.10 = ALAjuv_tailA2, TPM.11 = ALAjuv_tailB5, TPM.12 = NSC_vno))
View(dgePMucros)
dgePMucros <- rename(dgePMucros, TPM = HMAJ_testis, TPM.1 = HMAJ_heart, TPM.3 = ALA_vno, TPM.3 = ALA_tailA2, TPM.4 = ATEN_tailA2,
TPM.5 = ATEN_tailB5, TPM.6 = ATEN_body, TPM.7 = ALA_eye, TPM.8 = BRH_vno, TPM.9 = ALAjuv_body, TPM.10 = ALAjuv_tailA2, TPM.11 = ALAjuv_tailB5, TPM.12 = NSC_vno))
dgePMucros <- rename(dgePMucros, TPM = HMAJ_testis, TPM.1 = HMAJ_heart, TPM.3 = ALA_vno, TPM.3 = ALA_tailA2, TPM.4 = ATEN_tailA2,
TPM.5 = ATEN_tailB5, TPM.6 = ATEN_body, TPM.7 = ALA_eye, TPM.8 = BRH_vno, TPM.9 = ALAjuv_body, TPM.10 = ALAjuv_tailA2, TPM.11 = ALAjuv_tailB5, TPM.12 = NSC_vno))
names(dgePMucros)
names(dgePMucros)
dgePMucros <- select(dgePMucros, Name, TPM = HMAJ_testis, TPM.1 = HMAJ_heart, TPM.3 = ALA_vno, TPM.3 = ALA_tailA2, TPM.4 = ATEN_tailA2,
TPM.5 = ATEN_tailB5, TPM.6 = ATEN_body, TPM.7 = ALA_eye, TPM.8 = BRH_vno, TPM.9 = ALAjuv_body, TPM.10 = ALAjuv_tailA2, TPM.11 = ALAjuv_tailB5, TPM.12 = NSC_vno))
dgePMucros <- select(dgePMucros, Name, TPM = HMAJ_testis, TPM.1 = HMAJ_heart, TPM.3 = ALA_vno, TPM.3 = ALA_tailA2, TPM.4 = ATEN_tailA2,
TPM.5 = ATEN_tailB5, TPM.6 = ATEN_body, TPM.7 = ALA_eye, TPM.8 = BRH_vno, TPM.9 = ALAjuv_body, TPM.10 = ALAjuv_tailA2, TPM.11 = ALAjuv_tailB5, TPM.12 = NSC_vno))
library(magrittr)
library(tibble)
library(readr)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(tidyverse)
library(pheatmap)
names(dgePMucros)
dgePMucros <- select(dgePMucros, Name, TPM = HMAJ_testis, TPM.1 = HMAJ_heart, TPM.3 = ALA_vno, TPM.3 = ALA_tailA2, TPM.4 = ATEN_tailA2,
TPM.5 = ATEN_tailB5, TPM.6 = ATEN_body, TPM.7 = ALA_eye, TPM.8 = BRH_vno, TPM.9 = ALAjuv_body, TPM.10 = ALAjuv_tailA2, TPM.11 = ALAjuv_tailB5, TPM.12 = NSC_vno))
dgePMucros <- dgePMucros %>%
select(Name, TPM = HMAJ_testis, TPM.1 = HMAJ_heart, TPM.3 = ALA_vno, TPM.3 = ALA_tailA2, TPM.4 = ATEN_tailA2, TPM.5 = ATEN_tailB5, TPM.6 = ATEN_body, TPM.7 = ALA_eye, TPM.8 = BRH_vno, TPM.9 = ALAjuv_body, TPM.10 = ALAjuv_tailA2, TPM.11 = ALAjuv_tailB5, TPM.12 = NSC_vno))
select(Name, TPM = HMAJ_testis, TPM.1 = HMAJ_heart, TPM.3 = ALA_vno, TPM.3 = ALA_tailA2, TPM.4 = ATEN_tailA2, TPM.5 = ATEN_tailB5, TPM.6 = ATEN_body, TPM.7 = ALA_eye, TPM.8 = BRH_vno, TPM.9 = ALAjuv_body, TPM.10 = ALAjuv_tailA2, TPM.11 = ALAjuv_tailB5, TPM.12 = NSC_vno)
names(dgePMucros)
dgePMucros <- dgePMucros %>%
select(TPM = HMAJ_testis, TPM.1 = HMAJ_heart, TPM.3 = ALA_vno, TPM.3 = ALA_tailA2, TPM.4 = ATEN_tailA2, TPM.5 = ATEN_tailB5, TPM.6 = ATEN_body, TPM.7 = ALA_eye, TPM.8 = BRH_vno, TPM.9 = ALAjuv_body, TPM.10 = ALAjuv_tailA2, TPM.11 = ALAjuv_tailB5, TPM.12 = NSC_vno)
View(dgePMucros)
select(HMAJ_testis = TPM, TPM.1 = HMAJ_heart, TPM.3 = ALA_vno, TPM.3 = ALA_tailA2, TPM.4 = ATEN_tailA2, TPM.5 = ATEN_tailB5, TPM.6 = ATEN_body, TPM.7 = ALA_eye, TPM.8 = BRH_vno, TPM.9 = ALAjuv_body, TPM.10 = ALAjuv_tailA2, TPM.11 = ALAjuv_tailB5, TPM.12 = NSC_vno)
names(dgePMucros)
select(dgePMucros, Name) %>% head
select(dgePMucros, Name, HMAJ_testis = TPM) %>% head
ATEN_tailB5 = TPM.5, ATEN_body = TPM, ALA_eye = TPM.7, BRH_vno = TPM.8, ALAjuv_body = TPM.9, ALAjuv_tailA2 = TPM.10, ALAjuv_tailB5 = TPM.11, NSC_vno = TPM.12)
dgePMucros <- select(dgePMucros, Name, HMAJ_testis = TPM, HMAJ_heart = TPM.1, ALA_vno = TPM.2, ALA_tailA2 = TPM.3, ATEN_tailA2 = TPM.4,
ATEN_tailB5 = TPM.5, ATEN_body = TPM, ALA_eye = TPM.7, BRH_vno = TPM.8, ALAjuv_body = TPM.9, ALAjuv_tailA2 = TPM.10, ALAjuv_tailB5 = TPM.11, NSC_vno = TPM.12)
names(dgePMucros)
View(dgePMucros)
dgePMucros <- read.table(file = "PMucros_quant_tpm_all.tsv",
header = TRUE)
names(dgePMucros)
dgePMucros <- select(dgePMucros, Name, HMAJ_testis = TPM, HMAJ_heart = TPM.1, ALA_vno = TPM.2, ALA_tailA2 = TPM.3, ATEN_tailA2 = TPM.4,
ATEN_tailB5 = TPM.5, ATEN_body = TPM.6, ALA_eye = TPM.7, BRH_vno = TPM.8, ALAjuv_body = TPM.9, ALAjuv_tailA2 = TPM.10, ALAjuv_tailB5 = TPM.11, NSC_vno = TPM.12)
names(dgePMucros)
dgePMucros <- select(dgePMucros, GeneName = Name, HMAJ_testis = TPM, HMAJ_heart = TPM.1, ALA_vno = TPM.2, ALA_tailA2 = TPM.3, ATEN_tailA2 = TPM.4,
ATEN_tailB5 = TPM.5, ATEN_body = TPM.6, ALA_eye = TPM.7, BRH_vno = TPM.8, ALAjuv_body = TPM.9, ALAjuv_tailA2 = TPM.10, ALAjuv_tailB5 = TPM.11, NSC_vno = TPM.12)
dgePMucros <- read.table(file = "PMucros_quant_tpm_all.tsv",
dgePMucros <- select(dgePMucros, GeneName = Name, HMAJ_testis = TPM, HMAJ_heart = TPM.1, ALA_vno = TPM.2, ALA_tailA2 = TPM.3, ATEN_tailA2 = TPM.4,
ATEN_tailB5 = TPM.5, ATEN_body = TPM.6, ALA_eye = TPM.7, BRH_vno = TPM.8, ALAjuv_body = TPM.9, ALAjuv_tailA2 = TPM.10, ALAjuv_tailB5 = TPM.11, NSC_vno = TPM.12)
q
setwd("/Users/jennacrowe-riddell/Documents/tissue_profiling/salmon_quant/tpm_results")
dgePMucros <- read.table(file = "PMucros_quant_tpm_all.tsv", header = TRUE)
names(dgePMucros)
dgePMucros <- select(dgePMucros, GeneName = Name, HMAJ_testis = TPM, HMAJ_heart = TPM.1, ALA_vno = TPM.2, ALA_tailA2 = TPM.3, ATEN_tailA2 = TPM.4,
dgePMucros <- select(dgePMucros, GeneName = Name, HMAJ_testis = TPM, HMAJ_heart = TPM.1, ALA_vno = TPM.2, ALA_tailA2 = TPM.3, ATEN_tailA2 = TPM.4,
ATEN_tailB5 = TPM.5, ATEN_body = TPM.6, ALA_eye = TPM.7, BRH_vno = TPM.8, ALAjuv_body = TPM.9, ALAjuv_tailA2 = TPM.10, ALAjuv_tailB5 = TPM.11, NSC_vno = TPM.12)
qqq
dgePMucros <- select(dgePMucros, GeneName = Name, HMAJ_testis = TPM, HMAJ_heart = TPM.1, ALA_vno = TPM.2, ALA_tailA2 = TPM.3, ATEN_tailA2 = TPM.4,
ATEN_tailB5 = TPM.5, ATEN_body = TPM.6, ALA_eye = TPM.7, BRH_vno = TPM.8, ALAjuv_body = TPM.9, ALAjuv_tailA2 = TPM.10, ALAjuv_tailB5 = TPM.11, NSC_vno = TPM.12)
names(dgePMucros)
View(dgePMucros)
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
View(sampleinfo)
dge %<>% column_to_rownames("GeneName") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
dgePmucros %<>% column_to_rownames("GeneName") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
dgePmucros %<>% column_to_rownames("GeneName") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
dgePMucros %<>% column_to_rownames("GeneName") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
biocLite(edgeR)
biocLite("edgeR")
dgePMucros %<>% column_to_rownames("GeneName") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
dgePMucros %<>% column_to_rownames("GeneName") %>%
as.matrix() %>%
edgeR::DGEList() %>%
edgeR::calcNormFactors()
mds <- plotMDS(dgePMucros, gene.selection = "common", method = "logFC")
mds <- edgeR::plotMDS(dgePMucros, gene.selection = "common", method = "logFC")
mds <- edgeR::plotMDS(dgePMucros, gene.selection = "common", method = "logFC")
mds <- limma::plotMDS(dgePMucros, gene.selection = "common", method = "logFC")
View(sampleinfo)
plot <- mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y")) %>%
left_join(sampleinfo, by = c("group"="gene_id"))
plot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
pdf(file = "plots/MDS_PMucros.pdf")
plotplot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
plot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
dev.off()
plot %>%
ggplot(aes(x, y, colour = seqYear, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
quartz()
plot %>%
ggplot(aes(x, y, colour = seqYear, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
plot(hclust( d = dist(t(cpm(dge)),  method = "euclidean"),
method = "ward.D"),
hang = -1, xlab = "Samples", sub = "Distance=euclidean; Method=ward.D")
plot(hclust( d = dist(t(edgeR::cpm(dge)),  method = "euclidean"),
method = "ward.D"),
hang = -1, xlab = "Samples", sub = "Distance=euclidean; Method=ward.D")
plot(hclust( d = dist(t(edgeR::cpm(dgePMucros)),  method = "euclidean"),
method = "ward.D"),
hang = -1, xlab = "Samples", sub = "Distance=euclidean; Method=ward.D")
quartz()
plot(hclust( d = dist(t(edgeR::cpm(dgePMucros)),  method = "euclidean"),
method = "ward.D"),
hang = -1, xlab = "Samples", sub = "Distance=euclidean; Method=ward.D")
pdf(file = "plots/MDS_PMucros.pdf")
plot(hclust( d = dist(t(edgeR::cpm(dgePMucros)),  method = "euclidean"),
method = "ward.D"),
hang = -1, xlab = "Samples", sub = "Distance=euclidean; Method=ward.D")
dev.off()
pdf(file = "plots/MDS_PMucros.pdf")
plot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
dev.off()
## Sample clustering
pdf(file = "plots/hclust_PMucros.pdf")
plot(hclust( d = dist(t(edgeR::cpm(dgePMucros)),  method = "euclidean"),
method = "ward.D"),
hang = -1, xlab = "Samples", sub = "Distance=euclidean; Method=ward.D")
dev.off()
dgePMucros <- dgePMucros %>%
column_to_rownames("GeneName") %>%
select(HMAJ_heart, ALA_vno, HMAJ_testis, ATEN_tailA2, BRH_vno, NSC_vno, ALA_tailA2, ALAjuv_body, ALAjuv_tailA2, ALAjuv_tailB5,
ATEN_body, ATEN_tailB5, ALA_eye) %>% # set order of the tissues accroding to hclust
as.matrix() %>%
log1p()
TPM_Pmucros <- read.delim("PMucros_quant_tpm_all.tsv")
TPM_Pmucros <- select(TPM_Pmucros, GeneName = Name, HMAJ_testis = TPM, HMAJ_heart = TPM.1, ALA_vno = TPM.2, ALA_tailA2 = TPM.3, ATEN_tailA2 = TPM.4,
ATEN_tailB5 = TPM.5, ATEN_body = TPM.6, ALA_eye = TPM.7, BRH_vno = TPM.8, ALAjuv_body = TPM.9, ALAjuv_tailA2 = TPM.10, ALAjuv_tailB5 = TPM.11, NSC_vno = TPM.12)
View(TPM_Pmucros)
TPM_Pmucros <- TPM_Pmucros %>%
column_to_rownames("GeneName") %>%
select(HMAJ_heart, ALA_vno, HMAJ_testis, ATEN_tailA2, BRH_vno, NSC_vno, ALA_tailA2, ALAjuv_body, ALAjuv_tailA2, ALAjuv_tailB5,
ATEN_body, ATEN_tailB5, ALA_eye) %>% # set order of the tissues accroding to hclust
as.matrix() %>%
log1p()
View(TPM_Pmucros)
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE, color = colfunc)
pheatmap(TPM_Pmucros, cluster_rows = FALSE, cluster_cols = FALSE, color = colfunc)

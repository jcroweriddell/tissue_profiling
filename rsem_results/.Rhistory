install.packages("edgeR")
FPKMresults <- read.delim("rsem_all_together.tsv")
setwd("C:/Users/L033060262053/Documents/Research projects/Tail_photoreception/tissue_profiling/rsem_results/")
FPKMresults <- read.delim("rsem_all_together.tsv")
TPMresults <- read.delim("rsem_TPM_all_together.tsv")
geneNumToName <- read_delim("gene_number_to_name.tsv", delim = "\t", col_names = c("GeneID", "GeneName"))
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM, ALA_tailA2_FPKM, ALAjuv_tailA2_FPKM,
ALAjuv_tailB5_FPKM, ALAjuv_body_FPKM, ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM,
HMAJ_testis_FPKM)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO", "L345_06817", "gar1", "L345_18159", "L345_00724",
"L345_18159", "RDH16", "DHRS9", "RDH8")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM, ALA_tailA2_FPKM, ALAjuv_tailA2_FPKM,
ALAjuv_tailB5_FPKM, ALAjuv_body_FPKM, ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM,
HMAJ_testis_FPKM)
library(tidyverse)
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM, ALA_tailA2_FPKM, ALAjuv_tailA2_FPKM,
ALAjuv_tailB5_FPKM, ALAjuv_body_FPKM, ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM,
HMAJ_testis_FPKM)
geneNumToName <- read_delim("gene_number_to_name.tsv", delim = "\t", col_names = c("GeneID", "GeneName"))
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM, ALA_tailA2_FPKM, ALAjuv_tailA2_FPKM,
ALAjuv_tailB5_FPKM, ALAjuv_body_FPKM, ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM,
HMAJ_testis_FPKM)
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
View(visGenesFPKM)
heatmap(FPKMresults_gene,col= heat.colors(299))
heatmap(FPKMresults,col= heat.colors(299))
rnames <- FPKMresults_gene[,1] #assign Labels from column 1 to 'rnames'
mat_data <- data.matrix(FPKMresults_gene[,2:14(FPKMresults_gene)]) #tranform columns 2-14 in to matrix
mat_data <- data.matrix(FPKMresults_gene[,2:14]) #tranform columns 2-14 in to matrix
rownames(mat_data) <- rnames # assign rownames
heatmap(FPKMresults_gene,col= heat.colors(299))
rnames <- visGenesFPKM[,1] #assign Labels from column 1 to 'rnames'
mat_data <- data.matrix(visGenesFPKM[,2:14]) #tranform columns 2-14 in to matrix
rownames(mat_data) <- rnames # assign rownames
visGenesFPKM %>%
heatmap(mat_data, Rowv=NA, Colv = NA, col = head.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
FPKMresults <- read.delim("rsem_all_together.tsv")
geneNumToName <- read_delim("gene_number_to_name.tsv", delim = "\t", col_names = c("GeneID", "GeneName"))
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM, ALA_tailA2_FPKM, ALAjuv_tailA2_FPKM,
ALAjuv_tailB5_FPKM, ALAjuv_body_FPKM, ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM,
HMAJ_testis_FPKM)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO", "L345_06817", "gar1", "L345_18159", "L345_00724",
"L345_18159", "RDH16", "DHRS9", "RDH8")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
View(visGenesFPKM)
is.matrix(visGenesFPKM)
library(magrittr)
library(tibble)
library(readr)
library(dplyr)
library(ggplot2)
library(edgeR)
visGenesFPKM_m %<>%
data.matrix(frame, rownames.force = TRUE)
visGenesFPKM_m <- visGenesFPKM %>%
data.matrix(frame, rownames.force = TRUE)
visGenesFPKM_m <- visGenesFPKM %>%
data.matrix(, rownames.force = TRUE)
visGenesFPKM_m <- visGenesFPKM %>%
data.matrix( rownames.force = TRUE)
View(visGenesFPKM_m)
visGenesFPKM_m <- visGenesFPKM %>%
data.matrix(rownames.force = NA)
View(visGenesFPKM_m)
rm(visGenesFPKM_m)
visGenesFPKM_m <- visGenesFPKM %>%
data.matrix(rownames.force = NA)
View(visGenesFPKM_m)
rm(visGenesFPKM_m)
visGenesFPKM_m <- visGenesFPKM %>%
column_to_rownames("GeneName") %>%
as.matrix()
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO", "L345_06817", "gar1", "L345_18159", "L345_00724",
"L345_18159", "DHRS9")
geneList
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
View(visGenesFPKM)
is.na(visGenesFPKM)
View(visGenesFPKM)
geneList %>% filter("GeneName")
geneList %>% filter(GeneName)
geneList %>% filter(-(GeneName))
geneList %>% sort(-(GeneName))
visGenesFPKM %>% sort(-(GeneName))
View(visGenesFPKM)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO", "L345_06817", "L345_18159", "L345_00724",
"L345_18159", "DHRS9")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
View(visGenesFPKM)
rnames <- visGenesFPKM[,1] #assign Labels from column 1 to 'rnames'
mat_data <- data.matrix(visGenesFPKM[,2:14]) #tranform columns 2-14 in to matrix
rm(mat_data, rnames)
visGenesFPKM_m <- visGenesFPKM %>%
column_to_rownames("GeneName") %>%
as.matrix()
View(visGenesFPKM_m)
heatmap(visGenesFPKM_m, Rowv=NA, Colv = NA, col = head.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
heatmap(visGenesFPKM_m, Rowv=NA, Colv = NA, col = heat.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
heatmap(visGenesFPKM_m, Rowv=NA, Colv = NA, col = cm.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
library(RColorBrewer)
my_palette <-colorRampPalette(c("red", "yellow","green"))(n = 299)
heatmap(visGenesFPKM_m, Rowv=NA, Colv = NA, col = my_palette), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
heatmap(visGenesFPKM_m, Rowv=NA, Colv = NA, col = my_palette, #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
dev.off()
heatmap(visGenesFPKM_m, Rowv=NA, Colv = NA, col = my_palette, #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
my_palette <- brewer.pal(11,"RdBu")
heatmap(visGenesFPKM_m, Rowv=NA, Colv = NA, col = my_palette, #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
heatmap.2
library(heatmap.2)
heatmap.2(visGenesFPKM_m, Rowv=NA, Colv = NA, col = my_palette, #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
heatmap.2(visGenesFPKM_m, Rowv=NA, Colv = NA, col = cm.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
heatmap(visGenesFPKM_m, Rowv=NA, Colv = NA, col = cm.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
heatmap(visGenesFPKM_m, Rowv=NA, Colv = NA, col = heat.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
View(FPKMresults_gene)
View(visGenesFPKM)
lbrary(gplot)
library(ggplot2)
heatmap.2(visGenesFPKM_m, Rowv=NA, Colv = NA, col = heat.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
install.packages("gplots")
library(gplots)
heatmap.2(visGenesFPKM_m, Rowv=NA, Colv = NA, col = heat.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
heatmap.2(visGenesFPKM_m, Rowv=NA, Colv = NA, "white","green","green4","violet","purple"))(100)), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
heatmap.2(visGenesFPKM_m, Rowv=NA, Colv = NA, col = "white","green","green4","violet","purple"))(100)), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
heatmap.2(visGenesFPKM_m, Rowv=NA, Colv = NA, col = "white","green","green4","violet","purple"))(100)) #can also use inbuild col, e.g. cm.color or heat.color
heatmap.2(visGenesFPKM_m, Rowv=NA, Colv = NA, col = colorRampPalette(c("white","green","green4","violet","purple"))(100), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
heatmap.2(visGenesFPKM_m, col = colorRampPalette(c("white","green","green4","violet","purple"))(100), #can also use inbuild col, e.g. cm.color or heat.color
heatmap.2(as.matrix(your data),col =
colorRampPalette(c("white","green","green4","violet","purple"))(100))
library(heatmap.2)
dev.off()
heatmap.2(visGenesFPKM_m, col = colorRampPalette(c("white","green","green4","violet","purple"))(100), #can also use inbuild col, e.g. cm.color or heat.color
heatmap.2(as.matrix(your data),col =
colorRampPalette(c("white","green","green4","violet","purple"))(100))
library(heatmap.2)
dev.off()
heatmap.2(visGenesFPKM_m, col = colorRampPalette(c("white","green","green4","violet","purple"))(100), #can also use inbuild col, e.g. cm.color or heat.color
heatmap.2(as.matrix(your data),col =
colorRampPalette(c("white","green","green4","violet","purple"))(100))
library(heatmap.2)
dev.off()
heatmap.2(visGenesFPKM_m, col = colorRampPalette(c("white","green","green4","violet","purple"))(100)), #can also use inbuild col, e.g. cm.color or heat.color
heatmap.2(as.matrix(your data),col =
colorRampPalette(c("white","green","green4","violet","purple"))(100))
heatmap.2(visGenesFPKM_m, col = colorRampPalette(c("white","green","green4","violet","purple"))(100)) #can also use inbuild col, e.g. cm.color or heat.color
heatmap(visGenesFPKM_m, Rowv=NA, Colv = NA, col = cm.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
TPMresults_gene <- TPMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_TPM, ALA_vno_TPM, ALA_tailA2_TPM, ALAjuv_tailA2_TPM,
ALAjuv_tailB5_TPM, ALAjuv_body_TPM, ATEN_tailA2_TPM, ATEN_tailB5_TPM,
ATEN_body_TPM, NSC_vno_TPM, BRH_vno_TPM, HMAJ_heart_TPM,
HMAJ_testis_TPM)
TPMresults <- read.delim("rsem_TPM_all_together.tsv")
TPMresults_gene <- TPMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_TPM, ALA_vno_TPM, ALA_tailA2_TPM, ALAjuv_tailA2_TPM,
ALAjuv_tailB5_TPM, ALAjuv_body_TPM, ATEN_tailA2_TPM, ATEN_tailB5_TPM,
ATEN_body_TPM, NSC_vno_TPM, BRH_vno_TPM, HMAJ_heart_TPM,
HMAJ_testis_TPM)
head(TPMresults_gene)
visGenesTPM <- filter(TPMresults_gene, GeneName %in% geneList)
View(visGenesTPM)
visGenesTPM_m <- visGenesTPM %>%
column_to_rownames("GeneName") %>%
as.matrix()
heatmap(visGenesTPM_m, Rowv=NA, Colv = NA, col = cm.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
dge <- read.table(file = "visGenesFPKM.txt.tsv",
header = TRUE)
dge <- read.table(file = "visGenesFPKM.txt",
header = TRUE)
sample <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
dge %<>% column_to_rownames("GeneName") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
heatmap(dge, Rowv=NA, Colv = NA, col = cm.colors(299), #can also use inbuild col, e.g. cm.color or heat.color
scale = 'column', margins = c(5,10))
dge %<>% column_to_rownames("GeneName") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
dge %<>% as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
View(TPMresults_gene)
View(visGenesTPM)
?melt
visGenesFPKM.m <- melt(visGenesFPKM_m)
library(reshape2)
visGenesFPKM.m <- melt(visGenesFPKM_m)
visGenesFPKM.m <- ddply(visGenesFPKM.m, .(variable), transform,
+     rescale = rescale(value))
visGenesFPKM.m <- ddply(visGenesFPKM.m, .(variable), transform, rescale = rescale(value))
library(plyr)
visGenesFPKM.m <- ddply(visGenesFPKM.m, .(variable), transform, rescale = rescale(value))
View(FPKMresults_gene)
write.table(FPKMresults_gene, "visGenesFPKM.txt", sep="\t")
dge <- read.table(file = "visGenesFPKM.txt",
header = TRUE)
sample <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
dge %<>% column_to_rownames("gene_id") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
mds <- plotMDS(dge, gene.selection = "common", method = "logFC")
mds <- plotMDS(dge)
names(dge)
dge_expressed <- calcNormFactors(dge_expressed, method="TMM")

dge_expressed$samples
Photo <- as.factor(sampleinfo$experiment)
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
Photo <- as.factor(sampleinfo$experiment)
Photo
design <- model.matrix(~ Photo)
design
v <- voom(x, design, plot=TRUE)
V
v
vfit <- lmFit(v, design)
vfit <- contrasts.fit(vfit, contrasts = contr.matrix)
v
v <- voom(x, design, plot=TRUE)
library(limma)
vfit <- contrasts.fit(vfit, contrasts = contr.matrix)
colfunc <-colorRampPalette(bias = 1, c("white", "royalblue", "springgreen","yellow","red"))
FPKMresults <- read.delim("rsem_all_together.tsv")
geneNumToName <- read_delim("gene_number_to_name.tsv", delim = "\t", col_names = c("GeneID", "GeneName"))
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye = ALA_eye_FPKM, ALA_vno = ALA_vno_FPKM , ALA_tailA2 = ALA_tailA2_FPKM,
ALAjuv_tail = ALAjuv_tailA2_FPKM, ALAjuv_tailB5 = ALAjuv_tailB5_FPKM,
ALAjuv_body = ALAjuv_body_FPKM,ATEN_tail = ATEN_tailA2_FPKM, ATEN_tailB5= ATEN_tailB5_FPKM,
ATEN_body =  ATEN_body_FPKM,NSC_vno = NSC_vno_FPKM, BRH_vno = BRH_vno_FPKM,
HMAJ_heart =HMAJ_heart_FPKM, HMAJ_testis = HMAJ_testis_FPKM)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO", "L345_06817", "L345_18159", "L345_00724",
"L345_18159", "DHRS9")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
visGeneslogFPKM <- visGenesFPKM %>%
column_to_rownames("GeneName") %>%
as.matrix() %>%
log1p()
heatmap(visGeneslogFPKM, col= colfunc(50))
colfunc <-colorRampPalette(bias = 1, c("white", "yellow","red"))
heatmap(visGeneslogFPKM, col= colfunc(50))
colfunc <-colorRampPalette(bias = 1, c("white", "yellow","orange", "red"))
heatmap(visGeneslogFPKM, col= colfunc(50))
colfunc <-colorRampPalette(bias = 1, c("white", "green", "yellow","orange", "red"))
heatmap(visGeneslogFPKM, col= colfunc(50))
colfunc <-colorRampPalette(bias = 1, c("white", "springgreen", "yellow","orange", "red"))
heatmap(visGeneslogFPKM, col= colfunc(50))
dge <- read.table(file = "rsem_expectedCount_all_together_names.tsv",
header = TRUE)
sample <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
dge %<>% column_to_rownames("gene_id") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
mds <- plotMDS(dge, gene.selection = "common", method = "logFC")
plot <- mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y")) %>%
left_join(sample, by = c("group"="gene_id"))
plot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
plot
View(sample)
FPKMresults <- read.delim("rsem_all_together.tsv")
geneNumToName <- read_delim("gene_number_to_name.tsv", delim = "\t", col_names = c("GeneID", "GeneName"))
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye = ALA_eye_FPKM, ALA_vno = ALA_vno_FPKM , ALA_tailA2 = ALA_tailA2_FPKM,
ALAjuv_tail = ALAjuv_tailA2_FPKM, ALAjuv_tailB5 = ALAjuv_tailB5_FPKM,
ALAjuv_body = ALAjuv_body_FPKM,ATEN_tail = ATEN_tailA2_FPKM, ATEN_tailB5= ATEN_tailB5_FPKM,
ATEN_body =  ATEN_body_FPKM,NSC_vno = NSC_vno_FPKM, BRH_vno = BRH_vno_FPKM,
HMAJ_heart =HMAJ_heart_FPKM, HMAJ_testis = HMAJ_testis_FPKM)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO", "L345_06817", "L345_18159", "L345_00724",
"L345_18159", "DHRS9")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
View(visGenesFPKM)
dge <- read.table(file = "rsem_expectedCount_all_together_names.tsv",
header = TRUE)
View(dge)
dge %<>% column_to_rownames("gene_id") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
View(dge)
View(dge)
View(dge$counts)
names(deg)
names(dge)
dge$samples
mds <- plotMDS(dge, gene.selection = "common", method = "logFC")
class(mds)
mds@.Data
mds@.Data[[3]]
mds@.Data[[3]] %>%
as.data.frame()
mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group")
mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y"))
mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y")) %>%
left_join(sampleinfo, by = c("group"="gene_id"))
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
View(sampleinfo)
plot <- mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y")) %>%
left_join(sampleinfo, by = c("group"="gene_id"))
plot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
rm(list=ls())
library(magrittr)
library(tibble)
library(readr)
library(dplyr)
library(ggplot2)
library(edgeR)
library(RColorBrewer)
library(tidyverse)
setwd("C:/Users/L033060262053/Documents/Research projects/Tail_photoreception/tissue_profiling/rsem_results/")
dge <- read.table(file = "rsem_expectedCount_all_together_names.tsv",
header = TRUE)
View(dge$counts)
View(dge$counts)
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
View(sampleinfo)
dge %<>% column_to_rownames("gene_id") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
dge
mds <- plotMDS(dge, gene.selection = "common", method = "logFC")
plot <- mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y")) %>%
left_join(sampleinfo, by = c("group"="gene_id"))
plot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
plot
mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y")) %>%
left_join(sampleinfo, by = c("group"="gene_id"))
View(sampleinfo)
dge <- read.table(file = "rsem_expectedCount_all_together_names.tsv",
header = TRUE)
View(dge)
names(dge)
names(dge)[gsub("_count","",names(dge))]
names(dge) <- gsub("_count","",names(dge))
library(magrittr)
library(tibble)
library(readr)
library(dplyr)
library(ggplot2)
library(edgeR)
library(RColorBrewer)
library(tidyverse)
## Clustering data using MDS plot and dendrograms
## Set working directory
setwd("C:/Users/L033060262053/Documents/Research projects/Tail_photoreception/tissue_profiling/rsem_results/")
## Reading in counts object
dge <- read.table(file = "rsem_expectedCount_all_together_names.tsv",
header = TRUE)
names(dge) <- gsub("_count","",names(dge))
## Reading in sample object
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
## Turning counts object into DGElist and normalising
dge %<>% column_to_rownames("gene_id") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
## Obtaining MDS data object
mds <- plotMDS(dge, gene.selection = "common", method = "logFC")
## Slightly ganky way of doing this, but extracting MDS coordinate object and joining with sample information.
plot <- mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y")) %>%
left_join(sampleinfo, by = c("group"="gene_id"))
View(plot)
plot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
rm(list=ls())
library(knitr)
library(magrittr)
library(tibble)
library(readr)
library(dplyr)
library(ggplot2)
library(limma)
library(edgeR)
library(RColorBrewer)
library(tidyverse)
library(knitr)
library(magrittr)
library(tibble)
library(readr)
library(dplyr)
library(ggplot2)
library(limma)
library(edgeR)
library(RColorBrewer)
library(tidyverse)
load("dge.RData")
# names(dge) <- gsub("_count","",names(dge))
View(dge)
names(dge) <- gsub("_count","",names(dge))
FPKMresults <- read.delim("rsem_all_together.tsv")
geneNumToName <- read_delim("gene_number_to_name.tsv", delim = "\t", col_names = c("GeneID", "GeneName"))
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye = ALA_eye_FPKM, ALA_vno = ALA_vno_FPKM , ALA_tailA2 = ALA_tailA2_FPKM,
ALAjuv_tail = ALAjuv_tailA2_FPKM, ALAjuv_tailB5 = ALAjuv_tailB5_FPKM,
ALAjuv_body = ALAjuv_body_FPKM,ATEN_tail = ATEN_tailA2_FPKM, ATEN_tailB5= ATEN_tailB5_FPKM,
ATEN_body =  ATEN_body_FPKM,NSC_vno = NSC_vno_FPKM, BRH_vno = BRH_vno_FPKM,
HMAJ_heart =HMAJ_heart_FPKM, HMAJ_testis = HMAJ_testis_FPKM)
GL <- read_tsv(file = "visualGenes.tsv", col_names = FALSE)
View(GL)
GL <- GL$X1
GL
geneList <- read_tsv(file = "visualGenes.tsv", col_names = FALSE)
geneList <- geneList$X1
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
View(visGenesFPKM)
colfunc <-colorRampPalette(bias = 1, c("white", "springgreen", "yellow","orange", "red"))
heatmap(visGeneslogFPKM, col= colfunc(50))
heatmap(visGenesFPKM, col= colfunc(50))
visGeneslogFPKM <- visGenesFPKM %>%
column_to_rownames("GeneName") %>%
as.matrix() %>%
log1p()
colfunc <-colorRampPalette(bias = 1, c("white", "springgreen", "yellow","orange", "red"))
heatmap(visGeneslogFPKM, col= colfunc(50))
?heatmap
install.packages("pheatmap")
library(pheatmap)
pheatmap(visGeneslogFPKM)
?pheatmap
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE)
visGeneslogFPKM <- visGenesFPKM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tail, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO", "L345_06817", "L345_18159", "L345_00724",
"L345_18159", "DHRS9")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
visGeneslogFPKM <- visGenesFPKM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tail, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO",
"L345_06817", "L345_18159", "L345_00724",
"DHRS9")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
visGeneslogFPKM <- visGenesFPKM %>%
column_to_rownames("GeneName") %>%
select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tail, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE)
colfunc <- RColorBrewer::
?RColorBrewer
display.brewer.pal()
display.brewer.pal()
colfunc <- brewer.pal(n = 3, name = YIOrRd)
colfunc <- brewer.pal(n = 3, name = "YIOrRd")
colfunc <- brewer.pal(n = 3, name = "YLOrRd")
colfunc <- brewer.pal(n = 3, name = "YlOrRd")
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE, color = colfunc)
colfunc <- brewer.pal(n = 9, name = "YlOrRd")
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE, color = colfunc)
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE, color = colfunc)
colfunc <- brewer.pal(n = 15, name = "OrRd")
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE, color = colfunc)
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE, color = colfunc)
names(dge) <- gsub("_count","",names(dge))
sampleinfo <- read_csv(file = "sample_info_tissues.csv", col_names = TRUE)
dge %<>% column_to_rownames("gene_id") %>%
as.matrix() %>%
edgeR::DGEList() %>%
calcNormFactors()
mds <- plotMDS(dge, gene.selection = "common", method = "logFC")
plot <- mds@.Data[[3]] %>%
as.data.frame() %>%
rownames_to_column("group") %>%
set_colnames(c("group","x","y")) %>%
left_join(sampleinfo, by = c("group"="gene_id"))
plot %>%
ggplot(aes(x, y, colour = experiment, shape = species, label = tissue)) +
geom_point(size = 4) +
geom_text(hjust = 0, nudge_x = 0.2, check_overlap = TRUE) +
theme_bw(base_size = 16) +
theme(legend.text = element_text(size = 12)) +
labs(x = "Dimension 1",
y=  "Dimension 2")
plot(hclust( d = dist(t(cpm(dge)),  method = "euclidean"),
method = "ward.D"),
hang = -1, xlab = "Samples", sub = "Distance=euclidean; Method=ward.D")
rm(list = ls())
FPKMresults <- read.delim("rsem_all_together.tsv")
geneNumToName <- read_delim("gene_number_to_name.tsv", delim = "\t", col_names = c("GeneID", "GeneName"))
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM , ALA_tailA2_FPKM,
ALAjuv_tailA2_FPKM, ALAjuv_tailB5_FPKM,
AALAjuv_body_FPKM,ATEN_tail = ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM, HMAJ_testis_FPKM) %>%
gsub("_FPKM","",names())
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM , ALA_tailA2_FPKM,
ALAjuv_tailA2_FPKM, ALAjuv_tailB5_FPKM,
AALAjuv_body_FPKM,ATEN_tail = ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM, HMAJ_testis_FPKM)
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM , ALA_tailA2_FPKM,
ALAjuv_tailA2_FPKM, ALAjuv_tailB5_FPKM,
ALAjuv_body_FPKM,ATEN_tail = ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM, HMAJ_testis_FPKM)
View(FPKMresults_gene)
View(FPKMresults_gene)
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM , ALA_tailA2_FPKM,
ALAjuv_tailA2_FPKM, ALAjuv_tailB5_FPKM,
ALAjuv_body_FPKM,ATEN_tail = ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM, HMAJ_testis_FPKM) %>%
gsub("_FPKM","",names())
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM , ALA_tailA2_FPKM,
ALAjuv_tailA2_FPKM, ALAjuv_tailB5_FPKM,
ALAjuv_body_FPKM,ATEN_tail = ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM, HMAJ_testis_FPKM) %>%
gsub("_FPKM","",names(FPKMresults))
View(FPKMresults_gene)
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM , ALA_tailA2_FPKM,
ALAjuv_tailA2_FPKM, ALAjuv_tailB5_FPKM,
ALAjuv_body_FPKM, ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM, HMAJ_testis_FPKM) %>%
gsub("_FPKM","",names(FPKMresults_gene))
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_eye_FPKM, ALA_vno_FPKM , ALA_tailA2_FPKM,
ALAjuv_tailA2_FPKM, ALAjuv_tailB5_FPKM,
ALAjuv_body_FPKM, ATEN_tailA2_FPKM, ATEN_tailB5_FPKM,
ATEN_body_FPKM, NSC_vno_FPKM, BRH_vno_FPKM, HMAJ_heart_FPKM, HMAJ_testis_FPKM)
FPKMresults_gene <-   gsub("_FPKM","",names(FPKMresults_gene))
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO",
"L345_06817", "L345_18159", "L345_00724",
"DHRS9")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
rm(list = ls())
FPKMresults <- read.delim("rsem_all_together.tsv")
FPKMresults_gene <- gsub("_FPKM","",names(FPKMresults_gene))
FPKMresults_gene <- gsub("_FPKM","",names(FPKMresults))
FPKMresults_gene <- gsub("_FPKM","",names(FPKMresults)) %>% as.matrix()
View(FPKMresults_gene)
View(FPKMresults)
FPKMresults_gene <- gsub("_FPKM","",names(FPKMresults))
View(FPKMresults)
View(FPKMresults)
dge <- read.table(file = "rsem_expectedCount_all_together_names.tsv",
header = TRUE)
names(dge) <- gsub("_count","",names(dge))
View(dge)
View(FPKMresults)
View(dge)
View(FPKMresults)
View(dge)
rm(list = ls())
FPKMresults <- read.delim("rsem_all_together.tsv")
names(FPKMresults) <- gsub("_FPKM","",names(FPKMresults))
View(FPKMresults)
geneNumToName <- read_delim("gene_number_to_name.tsv", delim = "\t", col_names = c("GeneID", "GeneName"))
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_tailA2, ALAjuv_tailB5, ALAjuv_tail, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno)
View(FPKMresults)
FPKMresults_gene <- FPKMresults %>%
full_join(geneNumToName, by = c("gene_id" = "GeneID")) %>%
select(GeneName, ALA_tailA2, ALAjuv_tailB5, ALAjuv_tailA2, ALAjuv_body, ATEN_tailA2, ATEN_tailB5, ATEN_body,
HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO",
"L345_06817", "L345_18159", "L345_00724",
"DHRS9")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
visGeneslogFPKM <- visGenesFPKM %>%
column_to_rownames("GeneName") %>%
# select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tail, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
# HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE, color = colfunc)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO",
"L345_06817", "L345_18159", "L345_00724",
"DHRS9", "gar1")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
visGeneslogFPKM <- visGenesFPKM %>%
column_to_rownames("GeneName") %>%
# select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tail, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
# HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
colfunc <- brewer.pal(n = 9, name = "OrRd")
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE, color = colfunc)
View(visGenesFPKM)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO",
"L345_06817", "L345_18159", "L345_00724",
"DHRS9", "mchr1")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
View(visGenesFPKM)
visGeneslogFPKM <- visGenesFPKM %>%
column_to_rownames("GeneName") %>%
# select(ALA_tailA2, ALAjuv_tailB5, ALAjuv_tail, ALAjuv_body, ATEN_tail, ATEN_tailB5, ATEN_body,
# HMAJ_heart, HMAJ_testis, ALA_eye, ALA_vno, BRH_vno, NSC_vno) %>%# set order of the tissues
as.matrix() %>%
log1p()
pheatmap(visGeneslogFPKM, cluster_rows = FALSE, cluster_cols = FALSE, color = colfunc)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO",
"L345_06817", "L345_18159", "L345_00724",
"DHRS9", "MCHR1")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
View(visGenesFPKM)
FPKMresults_gene %>% filter(GeneName %in% "krt5")
FPKMresults_gene %>% filter(GeneName %in% "krt")
filter(FPKMresults_gene, GeneName %in% "krt")
KRT <- filter(FPKMresults_gene, GeneName %in% "krt(*)")
KRT
View(KRT)
rm(KRT)
KRT <- filter(FPKMresults_gene, GeneName %in% "krt*")
KRT <- filter(FPKMresults_gene, GeneName %in% "krt1")
KRT <- filter(FPKMresults_gene, GeneName %in% "GNAT1")
KRT <- filter(FPKMresults_gene, "GNAT1")
KRT <- filter(FPKMresults_gene, "GNAT1")
KRT <- filter(FPKMresults_gene, "ALA")
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO",
"L345_06817", "L345_18159", "L345_00724",
"DHRS9", "KRT*")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
View(visGenesFPKM)
geneList <- c("GNAT1", "GNAT2", "GNAT3", "grk7-a", "GUCY2D",
"GUCY2F",  "CUCA1A", "LRAT", "PDE6B", "PDE6C", "RDH8", "RPE65",
"OPN3", "OPN4", "OPN5", "ROD1", "ABCA4", "ARRB2", "RHO",
"L345_06817", "L345_18159", "L345_00724",
"DHRS9", "Krt5")
visGenesFPKM <- filter(FPKMresults_gene, GeneName %in% geneList)
View(visGenesFPKM)
